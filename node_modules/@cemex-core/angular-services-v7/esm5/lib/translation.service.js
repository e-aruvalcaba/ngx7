/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Inject, Injectable, Optional } from '@angular/core';
import { Http } from '@angular/http';
import { Subject } from 'rxjs';
import { Broadcaster } from '@cemex-core/events-v7';
var TranslationService = /** @class */ (function () {
    function TranslationService(eventBroadcaster, http, _productPath, useTranslationServer, _translationUrl) {
        this.eventBroadcaster = eventBroadcaster;
        this.http = http;
        this._productPath = _productPath;
        this.useTranslationServer = useTranslationServer;
        this._translationUrl = _translationUrl;
        this._useTranslationServer = false;
        this.productPath = '';
        this._localeData = new Subject();
        this.productPath = _productPath || '/';
        this._useTranslationServer = useTranslationServer || false;
        if (this._translationUrl === null) {
            this._translationUrl = '/translate/translate';
        }
        if (this.isRunningOnBrowser()) {
            /** @type {?} */
            var comingFromReact = ((/** @type {?} */ (global))).sessionStorage.getItem('language') || 'en_US';
            /** @type {?} */
            var langLocalStorage = ((/** @type {?} */ (global))).localStorage.getItem('language');
            if (comingFromReact.indexOf('es') !== -1 && !this._useTranslationServer) {
                langLocalStorage = 'es';
                ((/** @type {?} */ (global))).localStorage.setItem('language', 'es');
            }
            else if (comingFromReact.indexOf('en') !== -1 &&
                !this._useTranslationServer) {
                langLocalStorage = 'en';
                ((/** @type {?} */ (global))).localStorage.setItem('language', 'en');
            }
            else {
                langLocalStorage = comingFromReact;
                ((/** @type {?} */ (global))).localStorage.setItem('language', langLocalStorage);
            }
            /** @type {?} */
            var localLang = void 0;
            if (this._useTranslationServer) {
                this.lang(langLocalStorage ? langLocalStorage : 'en_US');
                localLang = langLocalStorage ? langLocalStorage : 'en_US';
            }
            else {
                this.lang(langLocalStorage ? langLocalStorage : 'en');
                localLang = langLocalStorage ? langLocalStorage : 'en';
            }
            // add this next line to correct react projects
            if (localLang === 'en') {
                localLang = localLang + '_US';
            }
            else if (localLang === 'es') {
                localLang = localLang + '_MX';
            }
            ((/** @type {?} */ (global))).sessionStorage.setItem('language', localLang);
        }
        else {
            if (this._useTranslationServer) {
                this.lang('en_US');
            }
            else {
                this.lang('en');
            }
        }
    }
    /**
     * st comes from static-translation
     */
    /**
     * st comes from static-translation
     * @param {?} textID
     * @return {?}
     */
    TranslationService.st = /**
     * st comes from static-translation
     * @param {?} textID
     * @return {?}
     */
    function (textID) {
        /** @type {?} */
        var textValue = this.translation.get(textID);
        if (!textValue || textValue === undefined) {
            return 'NOT:' + textID;
        }
        return textValue;
    };
    /**
     * gets all translations
     */
    /**
     * gets all translations
     * @return {?}
     */
    TranslationService.all = /**
     * gets all translations
     * @return {?}
     */
    function () {
        /** @type {?} */
        var result = this.translation;
        return result;
    };
    Object.defineProperty(TranslationService.prototype, "localeData", {
        get: /**
         * @return {?}
         */
        function () {
            return this._localeData.asObservable();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TranslationService.prototype.isRunningOnBrowser = /**
     * @return {?}
     */
    function () {
        return ((/** @type {?} */ (global))) !== null && ((/** @type {?} */ (global))) !== undefined;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    TranslationService.prototype.onChange = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        this.labels = value;
        this._localeData.next(value);
    };
    /**
     * this method is left here for backwards compatibility
     */
    /**
     * this method is left here for backwards compatibility
     * @param {?} lang
     * @return {?}
     */
    TranslationService.prototype.lang = /**
     * this method is left here for backwards compatibility
     * @param {?} lang
     * @return {?}
     */
    function (lang) {
        var _this = this;
        if (lang === TranslationService.language) {
            return;
        }
        TranslationService.language = lang;
        // add this next line to correct react projects, need to correct this
        /** @type {?} */
        var localLang = TranslationService.language;
        if (localLang === 'en') {
            localLang = localLang + '_US';
        }
        else if (localLang === 'es') {
            localLang = localLang + '_MX';
        }
        if (this.isRunningOnBrowser()) {
            sessionStorage.setItem('language', localLang);
        }
        // if the language is only 2 letters it might be a legacy application
        if (!this._useTranslationServer) {
            this.http
                .get(this.productPath + 'vendor/locale-' + lang + '.json')
                .toPromise()
                .then((/**
             * @param {?} response
             * @return {?}
             */
            function (response) { return _this.populateTranslation(response.json()); }))
                .catch(this.handleError);
        }
        else {
            // if the translation name is bigger than 2 letters, request to external server
            this.http
                .get(this._translationUrl + this.productPath + localLang)
                .toPromise()
                .then((/**
             * @param {?} response
             * @return {?}
             */
            function (response) { return _this.populateTranslation(response.json()); }))
                .catch(this.handleError);
        }
    };
    /**
     * @param {?} lang
     * @return {?}
     */
    TranslationService.prototype.isoLang = /**
     * @param {?} lang
     * @return {?}
     */
    function (lang) {
        // must contain either one of these symbols
        if (lang.indexOf('-') !== -1 || lang.indexOf('_') !== -1) {
            TranslationService.language = lang;
            ((/** @type {?} */ (global))).sessionStorage.setItem('language', lang);
        }
    };
    /**
     * @param {?} url
     * @return {?}
     */
    TranslationService.prototype.file = /**
     * @param {?} url
     * @return {?}
     */
    function (url) {
        var _this = this;
        this.http
            .get(url)
            .toPromise()
            .then((/**
         * @param {?} response
         * @return {?}
         */
        function (response) { return _this.populateTranslation(response.json()); }))
            .catch(this.handleError);
    };
    /**
     * pt comes from public-translation
     */
    /**
     * pt comes from public-translation
     * @param {?} textID
     * @return {?}
     */
    TranslationService.prototype.pt = /**
     * pt comes from public-translation
     * @param {?} textID
     * @return {?}
     */
    function (textID) {
        /** @type {?} */
        var textValue = TranslationService.translation.get(textID);
        if (!textValue || textValue === undefined) {
            return 'NOT:' + textID;
        }
        return textValue;
    };
    /**
     * @param {?} textId
     * @return {?}
     */
    TranslationService.prototype.getLabel = /**
     * @param {?} textId
     * @return {?}
     */
    function (textId) {
        /** @type {?} */
        var textValue = TranslationService.translation.get(textId);
        if (!textValue) {
            return undefined;
        }
        return textValue;
    };
    /**
     * @return {?}
     */
    TranslationService.prototype.getlang = /**
     * @return {?}
     */
    function () {
        return TranslationService.language;
    };
    /**
     * @return {?}
     */
    TranslationService.prototype.getCountryCode = /**
     * @return {?}
     */
    function () {
        return TranslationService.language.split('_')[1];
    };
    /**
     * @param {?} result
     * @return {?}
     */
    TranslationService.prototype.populateTranslation = /**
     * @param {?} result
     * @return {?}
     */
    function (result) {
        var e_1, _a;
        try {
            for (var _b = tslib_1.__values(Object.keys(result)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                TranslationService.translation.set(item, result[item]);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.eventBroadcaster.broadcast(Broadcaster.DCM_LANGUAGE_FETCHED, TranslationService.language);
        this.onChange(result);
    };
    /**
     * @param {?} error
     * @return {?}
     */
    TranslationService.prototype.handleError = /**
     * @param {?} error
     * @return {?}
     */
    function (error) {
        return Promise.reject(error.message || error);
    };
    TranslationService.translation = new Map();
    TranslationService.language = '';
    // Must be set on path constants
    TranslationService.PRODUCT_PATH = 'PRODUCT_PATH';
    TranslationService.USE_TRANSLATION_SERVER = 'USE_TRANSLATION_SERVER';
    TranslationService.TRANSLATION_BASE_URL = 'TRANSLATION_BASE_URL';
    TranslationService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    TranslationService.ctorParameters = function () { return [
        { type: Broadcaster },
        { type: Http },
        { type: String, decorators: [{ type: Inject, args: [TranslationService.PRODUCT_PATH,] }, { type: Optional }] },
        { type: Boolean, decorators: [{ type: Inject, args: [TranslationService.USE_TRANSLATION_SERVER,] }, { type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [TranslationService.TRANSLATION_BASE_URL,] }, { type: Optional }] }
    ]; };
    return TranslationService;
}());
export { TranslationService };
if (false) {
    /** @type {?} */
    TranslationService.translation;
    /** @type {?} */
    TranslationService.language;
    /** @type {?} */
    TranslationService.PRODUCT_PATH;
    /** @type {?} */
    TranslationService.USE_TRANSLATION_SERVER;
    /** @type {?} */
    TranslationService.TRANSLATION_BASE_URL;
    /** @type {?} */
    TranslationService.prototype.labels;
    /** @type {?} */
    TranslationService.prototype._useTranslationServer;
    /** @type {?} */
    TranslationService.prototype.productPath;
    /** @type {?} */
    TranslationService.prototype._localeData;
    /** @type {?} */
    TranslationService.prototype.eventBroadcaster;
    /** @type {?} */
    TranslationService.prototype.http;
    /** @type {?} */
    TranslationService.prototype._productPath;
    /** @type {?} */
    TranslationService.prototype.useTranslationServer;
    /** @type {?} */
    TranslationService.prototype._translationUrl;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNsYXRpb24uc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BjZW1leC1jb3JlL2FuZ3VsYXItc2VydmljZXMtdjcvIiwic291cmNlcyI6WyJsaWIvdHJhbnNsYXRpb24uc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM3RCxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXJDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFL0IsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBSXBEO0lBbUNFLDRCQUNTLGdCQUE2QixFQUM3QixJQUFVLEVBR1YsWUFBb0IsRUFHcEIsb0JBQTZCLEVBRzdCLGVBQXVCO1FBVnZCLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBYTtRQUM3QixTQUFJLEdBQUosSUFBSSxDQUFNO1FBR1YsaUJBQVksR0FBWixZQUFZLENBQVE7UUFHcEIseUJBQW9CLEdBQXBCLG9CQUFvQixDQUFTO1FBRzdCLG9CQUFlLEdBQWYsZUFBZSxDQUFRO1FBbkN6QiwwQkFBcUIsR0FBRyxLQUFLLENBQUM7UUFFOUIsZ0JBQVcsR0FBRyxFQUFFLENBQUM7UUFDakIsZ0JBQVcsR0FBaUIsSUFBSSxPQUFPLEVBQU8sQ0FBQztRQWtDcEQsSUFBSSxDQUFDLFdBQVcsR0FBRyxZQUFZLElBQUksR0FBRyxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxxQkFBcUIsR0FBRyxvQkFBb0IsSUFBSSxLQUFLLENBQUM7UUFFM0QsSUFBSSxJQUFJLENBQUMsZUFBZSxLQUFLLElBQUksRUFBRTtZQUNqQyxJQUFJLENBQUMsZUFBZSxHQUFHLHNCQUFzQixDQUFDO1NBQy9DO1FBRUQsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUUsRUFBRTs7Z0JBQ3ZCLGVBQWUsR0FDbkIsQ0FB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LElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLENBQzdCLFdBQVcsQ0FBQyxvQkFBb0IsRUFDaEMsa0JBQWtCLENBQUMsUUFBUSxDQUM1QixDQUFDO1FBQ0YsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN4QixDQUFDOzs7OztJQUVNLHdDQUFXOzs7O0lBQWxCLFVBQW1CLEtBQVU7UUFDM0IsT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLElBQUksS0FBSyxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQXpNYSw4QkFBVyxHQUF3QixJQUFJLEdBQUcsRUFBa0IsQ0FBQztJQUM3RCwyQkFBUSxHQUFHLEVBQUUsQ0FBQzs7SUFHZCwrQkFBWSxHQUFHLGNBQWMsQ0FBQztJQUM5Qix5Q0FBc0IsR0FBRyx3QkFBd0IsQ0FBQztJQUNsRCx1Q0FBb0IsR0FBRyxzQkFBc0IsQ0FBQzs7Z0JBUjdELFVBQVU7Ozs7Z0JBSkYsV0FBVztnQkFKWCxJQUFJOzZDQThDUixNQUFNLFNBQUMsa0JBQWtCLENBQUMsWUFBWSxjQUN0QyxRQUFROzhDQUVSLE1BQU0sU0FBQyxrQkFBa0IsQ0FBQyxzQkFBc0IsY0FDaEQsUUFBUTs2Q0FFUixNQUFNLFNBQUMsa0JBQWtCLENBQUMsb0JBQW9CLGNBQzlDLFFBQVE7O0lBK0piLHlCQUFDO0NBQUEsQUE1TUQsSUE0TUM7U0EzTVksa0JBQWtCOzs7SUFDN0IsK0JBQTJFOztJQUMzRSw0QkFBNEI7O0lBRzVCLGdDQUE0Qzs7SUFDNUMsMENBQWdFOztJQUNoRSx3Q0FBNEQ7O0lBRTVELG9DQUFtQjs7SUFDbkIsbURBQXFDOztJQUVyQyx5Q0FBd0I7O0lBQ3hCLHlDQUFzRDs7SUFzQnBELDhDQUFvQzs7SUFDcEMsa0NBQWlCOztJQUNqQiwwQ0FFMkI7O0lBQzNCLGtEQUVvQzs7SUFDcEMsNkNBRThCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0LCBJbmplY3RhYmxlLCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cCB9IGZyb20gJ0Bhbmd1bGFyL2h0dHAnO1xuXG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7IEJyb2FkY2FzdGVyIH0gZnJvbSAnQGNlbWV4LWNvcmUvZXZlbnRzLXY3JztcblxuZGVjbGFyZSB2YXIgZ2xvYmFsOiBhbnk7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvblNlcnZpY2Uge1xuICBwdWJsaWMgc3RhdGljIHRyYW5zbGF0aW9uOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcbiAgcHVibGljIHN0YXRpYyBsYW5ndWFnZSA9ICcnO1xuICAvLyBNdXN0IGJlIHNldCBvbiBwYXRoIGNvbnN0YW50c1xuXG4gIHB1YmxpYyBzdGF0aWMgUFJPRFVDVF9QQVRIID0gJ1BST0RVQ1RfUEFUSCc7XG4gIHB1YmxpYyBzdGF0aWMgVVNFX1RSQU5TTEFUSU9OX1NFUlZFUiA9ICdVU0VfVFJBTlNMQVRJT05fU0VSVkVSJztcbiAgcHVibGljIHN0YXRpYyBUUkFOU0xBVElPTl9CQVNFX1VSTCA9ICdUUkFOU0xBVElPTl9CQVNFX1VSTCc7XG5cbiAgcHVibGljIGxhYmVsczogYW55O1xuICBwdWJsaWMgX3VzZVRyYW5zbGF0aW9uU2VydmVyID0gZmFsc2U7XG5cbiAgcHVibGljIHByb2R1Y3RQYXRoID0gJyc7XG4gIHB1YmxpYyBfbG9jYWxlRGF0YTogU3ViamVjdDxhbnk+ID0gbmV3IFN1YmplY3Q8YW55PigpO1xuXG4gIC8qKlxuICAgKiBzdCBjb21lcyBmcm9tIHN0YXRpYy10cmFuc2xhdGlvblxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBzdCh0ZXh0SUQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgdGV4dFZhbHVlID0gdGhpcy50cmFuc2xhdGlvbi5nZXQodGV4dElEKTtcbiAgICBpZiAoIXRleHRWYWx1ZSB8fCB0ZXh0VmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuICdOT1Q6JyArIHRleHRJRDtcbiAgICB9XG4gICAgcmV0dXJuIHRleHRWYWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBnZXRzIGFsbCB0cmFuc2xhdGlvbnNcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgYWxsKCk6IE1hcDxzdHJpbmcsIHN0cmluZz4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMudHJhbnNsYXRpb247XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBldmVudEJyb2FkY2FzdGVyOiBCcm9hZGNhc3RlcixcbiAgICBwdWJsaWMgaHR0cDogSHR0cCxcbiAgICBASW5qZWN0KFRyYW5zbGF0aW9uU2VydmljZS5QUk9EVUNUX1BBVEgpXG4gICAgQE9wdGlvbmFsKClcbiAgICBwdWJsaWMgX3Byb2R1Y3RQYXRoOiBzdHJpbmcsXG4gICAgQEluamVjdChUcmFuc2xhdGlvblNlcnZpY2UuVVNFX1RSQU5TTEFUSU9OX1NFUlZFUilcbiAgICBAT3B0aW9uYWwoKVxuICAgIHB1YmxpYyB1c2VUcmFuc2xhdGlvblNlcnZlcjogYm9vbGVhbixcbiAgICBASW5qZWN0KFRyYW5zbGF0aW9uU2VydmljZS5UUkFOU0xBVElPTl9CQVNFX1VSTClcbiAgICBAT3B0aW9uYWwoKVxuICAgIHB1YmxpYyBfdHJhbnNsYXRpb25Vcmw6IHN0cmluZ1xuICApIHtcbiAgICB0aGlzLnByb2R1Y3RQYXRoID0gX3Byb2R1Y3RQYXRoIHx8ICcvJztcbiAgICB0aGlzLl91c2VUcmFuc2xhdGlvblNlcnZlciA9IHVzZVRyYW5zbGF0aW9uU2VydmVyIHx8IGZhbHNlO1xuXG4gICAgaWYgKHRoaXMuX3RyYW5zbGF0aW9uVXJsID09PSBudWxsKSB7XG4gICAgICB0aGlzLl90cmFuc2xhdGlvblVybCA9ICcvdHJhbnNsYXRlL3RyYW5zbGF0ZSc7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNSdW5uaW5nT25Ccm93c2VyKCkpIHtcbiAgICAgIGNvbnN0IGNvbWluZ0Zyb21SZWFjdCA9XG4gICAgICAgIChnbG9iYWwgYXMgYW55KS5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdsYW5ndWFnZScpIHx8ICdlbl9VUyc7XG4gICAgICBsZXQgbGFuZ0xvY2FsU3RvcmFnZSA9IChnbG9iYWwgYXMgYW55KS5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGFuZ3VhZ2UnKTtcbiAgICAgIGlmIChjb21pbmdGcm9tUmVhY3QuaW5kZXhPZignZXMnKSAhPT0gLTEgJiYgIXRoaXMuX3VzZVRyYW5zbGF0aW9uU2VydmVyKSB7XG4gICAgICAgIGxhbmdMb2NhbFN0b3JhZ2UgPSAnZXMnO1xuICAgICAgICAoZ2xvYmFsIGFzIGFueSkubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xhbmd1YWdlJywgJ2VzJyk7XG4gICAgICB9IGVsc2UgaWYgKFxuICAgICAgICBjb21pbmdGcm9tUmVhY3QuaW5kZXhPZignZW4nKSAhPT0gLTEgJiZcbiAgICAgICAgIXRoaXMuX3VzZVRyYW5zbGF0aW9uU2VydmVyXG4gICAgICApIHtcbiAgICAgICAgbGFuZ0xvY2FsU3RvcmFnZSA9ICdlbic7XG4gICAgICAgIChnbG9iYWwgYXMgYW55KS5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbGFuZ3VhZ2UnLCAnZW4nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxhbmdMb2NhbFN0b3JhZ2UgPSBjb21pbmdGcm9tUmVhY3Q7XG4gICAgICAgIChnbG9iYWwgYXMgYW55KS5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbGFuZ3VhZ2UnLCBsYW5nTG9jYWxTdG9yYWdlKTtcbiAgICAgIH1cbiAgICAgIGxldCBsb2NhbExhbmc6IHN0cmluZztcbiAgICAgIGlmICh0aGlzLl91c2VUcmFuc2xhdGlvblNlcnZlcikge1xuICAgICAgICB0aGlzLmxhbmcobGFuZ0xvY2FsU3RvcmFnZSA/IGxhbmdMb2NhbFN0b3JhZ2UgOiAnZW5fVVMnKTtcbiAgICAgICAgbG9jYWxMYW5nID0gbGFuZ0xvY2FsU3RvcmFnZSA/IGxhbmdMb2NhbFN0b3JhZ2UgOiAnZW5fVVMnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5sYW5nKGxhbmdMb2NhbFN0b3JhZ2UgPyBsYW5nTG9jYWxTdG9yYWdlIDogJ2VuJyk7XG4gICAgICAgIGxvY2FsTGFuZyA9IGxhbmdMb2NhbFN0b3JhZ2UgPyBsYW5nTG9jYWxTdG9yYWdlIDogJ2VuJztcbiAgICAgIH1cblxuICAgICAgLy8gYWRkIHRoaXMgbmV4dCBsaW5lIHRvIGNvcnJlY3QgcmVhY3QgcHJvamVjdHNcblxuICAgICAgaWYgKGxvY2FsTGFuZyA9PT0gJ2VuJykge1xuICAgICAgICBsb2NhbExhbmcgPSBsb2NhbExhbmcgKyAnX1VTJztcbiAgICAgIH0gZWxzZSBpZiAobG9jYWxMYW5nID09PSAnZXMnKSB7XG4gICAgICAgIGxvY2FsTGFuZyA9IGxvY2FsTGFuZyArICdfTVgnO1xuICAgICAgfVxuICAgICAgKGdsb2JhbCBhcyBhbnkpLnNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2xhbmd1YWdlJywgbG9jYWxMYW5nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMuX3VzZVRyYW5zbGF0aW9uU2VydmVyKSB7XG4gICAgICAgIHRoaXMubGFuZygnZW5fVVMnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubGFuZygnZW4nKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwdWJsaWMgZ2V0IGxvY2FsZURhdGEoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xvY2FsZURhdGEuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICBwdWJsaWMgaXNSdW5uaW5nT25Ccm93c2VyKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoZ2xvYmFsIGFzIGFueSkgIT09IG51bGwgJiYgKGdsb2JhbCBhcyBhbnkpICE9PSB1bmRlZmluZWQ7XG4gIH1cblxuICBwdWJsaWMgb25DaGFuZ2UodmFsdWU6IGFueSk6IHZvaWQge1xuICAgIHRoaXMubGFiZWxzID0gdmFsdWU7XG4gICAgdGhpcy5fbG9jYWxlRGF0YS5uZXh0KHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiB0aGlzIG1ldGhvZCBpcyBsZWZ0IGhlcmUgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5XG4gICAqL1xuICBwdWJsaWMgbGFuZyhsYW5nOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAobGFuZyA9PT0gVHJhbnNsYXRpb25TZXJ2aWNlLmxhbmd1YWdlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFRyYW5zbGF0aW9uU2VydmljZS5sYW5ndWFnZSA9IGxhbmc7XG4gICAgLy8gYWRkIHRoaXMgbmV4dCBsaW5lIHRvIGNvcnJlY3QgcmVhY3QgcHJvamVjdHMsIG5lZWQgdG8gY29ycmVjdCB0aGlzXG4gICAgbGV0IGxvY2FsTGFuZzogc3RyaW5nID0gVHJhbnNsYXRpb25TZXJ2aWNlLmxhbmd1YWdlO1xuICAgIGlmIChsb2NhbExhbmcgPT09ICdlbicpIHtcbiAgICAgIGxvY2FsTGFuZyA9IGxvY2FsTGFuZyArICdfVVMnO1xuICAgIH0gZWxzZSBpZiAobG9jYWxMYW5nID09PSAnZXMnKSB7XG4gICAgICBsb2NhbExhbmcgPSBsb2NhbExhbmcgKyAnX01YJztcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNSdW5uaW5nT25Ccm93c2VyKCkpIHtcbiAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2xhbmd1YWdlJywgbG9jYWxMYW5nKTtcbiAgICB9XG4gICAgLy8gaWYgdGhlIGxhbmd1YWdlIGlzIG9ubHkgMiBsZXR0ZXJzIGl0IG1pZ2h0IGJlIGEgbGVnYWN5IGFwcGxpY2F0aW9uXG4gICAgaWYgKCF0aGlzLl91c2VUcmFuc2xhdGlvblNlcnZlcikge1xuICAgICAgdGhpcy5odHRwXG4gICAgICAgIC5nZXQodGhpcy5wcm9kdWN0UGF0aCArICd2ZW5kb3IvbG9jYWxlLScgKyBsYW5nICsgJy5qc29uJylcbiAgICAgICAgLnRvUHJvbWlzZSgpXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHRoaXMucG9wdWxhdGVUcmFuc2xhdGlvbihyZXNwb25zZS5qc29uKCkpKVxuICAgICAgICAuY2F0Y2godGhpcy5oYW5kbGVFcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGlmIHRoZSB0cmFuc2xhdGlvbiBuYW1lIGlzIGJpZ2dlciB0aGFuIDIgbGV0dGVycywgcmVxdWVzdCB0byBleHRlcm5hbCBzZXJ2ZXJcbiAgICAgIHRoaXMuaHR0cFxuICAgICAgICAuZ2V0KHRoaXMuX3RyYW5zbGF0aW9uVXJsICsgdGhpcy5wcm9kdWN0UGF0aCArIGxvY2FsTGFuZylcbiAgICAgICAgLnRvUHJvbWlzZSgpXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHRoaXMucG9wdWxhdGVUcmFuc2xhdGlvbihyZXNwb25zZS5qc29uKCkpKVxuICAgICAgICAuY2F0Y2godGhpcy5oYW5kbGVFcnJvcik7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGlzb0xhbmcobGFuZzogc3RyaW5nKTogdm9pZCB7XG4gICAgLy8gbXVzdCBjb250YWluIGVpdGhlciBvbmUgb2YgdGhlc2Ugc3ltYm9sc1xuICAgIGlmIChsYW5nLmluZGV4T2YoJy0nKSAhPT0gLTEgfHwgbGFuZy5pbmRleE9mKCdfJykgIT09IC0xKSB7XG4gICAgICBUcmFuc2xhdGlvblNlcnZpY2UubGFuZ3VhZ2UgPSBsYW5nO1xuICAgICAgKGdsb2JhbCBhcyBhbnkpLnNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2xhbmd1YWdlJywgbGFuZyk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGZpbGUodXJsOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLmh0dHBcbiAgICAgIC5nZXQodXJsKVxuICAgICAgLnRvUHJvbWlzZSgpXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB0aGlzLnBvcHVsYXRlVHJhbnNsYXRpb24ocmVzcG9uc2UuanNvbigpKSlcbiAgICAgIC5jYXRjaCh0aGlzLmhhbmRsZUVycm9yKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBwdCBjb21lcyBmcm9tIHB1YmxpYy10cmFuc2xhdGlvblxuICAgKi9cbiAgcHVibGljIHB0KHRleHRJRDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCB0ZXh0VmFsdWUgPSBUcmFuc2xhdGlvblNlcnZpY2UudHJhbnNsYXRpb24uZ2V0KHRleHRJRCk7XG4gICAgaWYgKCF0ZXh0VmFsdWUgfHwgdGV4dFZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiAnTk9UOicgKyB0ZXh0SUQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRleHRWYWx1ZTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRMYWJlbCh0ZXh0SWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgdGV4dFZhbHVlID0gVHJhbnNsYXRpb25TZXJ2aWNlLnRyYW5zbGF0aW9uLmdldCh0ZXh0SWQpO1xuICAgIGlmICghdGV4dFZhbHVlKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gdGV4dFZhbHVlO1xuICB9XG5cbiAgcHVibGljIGdldGxhbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gVHJhbnNsYXRpb25TZXJ2aWNlLmxhbmd1YWdlO1xuICB9XG5cbiAgcHVibGljIGdldENvdW50cnlDb2RlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIFRyYW5zbGF0aW9uU2VydmljZS5sYW5ndWFnZS5zcGxpdCgnXycpWzFdO1xuICB9XG5cbiAgcHVibGljIHBvcHVsYXRlVHJhbnNsYXRpb24ocmVzdWx0KSB7XG4gICAgZm9yIChjb25zdCBpdGVtIG9mIE9iamVjdC5rZXlzKHJlc3VsdCkpIHtcbiAgICAgIFRyYW5zbGF0aW9uU2VydmljZS50cmFuc2xhdGlvbi5zZXQoaXRlbSwgcmVzdWx0W2l0ZW1dKTtcbiAgICB9XG4gICAgdGhpcy5ldmVudEJyb2FkY2FzdGVyLmJyb2FkY2FzdChcbiAgICAgIEJyb2FkY2FzdGVyLkRDTV9MQU5HVUFHRV9GRVRDSEVELFxuICAgICAgVHJhbnNsYXRpb25TZXJ2aWNlLmxhbmd1YWdlXG4gICAgKTtcbiAgICB0aGlzLm9uQ2hhbmdlKHJlc3VsdCk7XG4gIH1cblxuICBwdWJsaWMgaGFuZGxlRXJyb3IoZXJyb3I6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yLm1lc3NhZ2UgfHwgZXJyb3IpO1xuICB9XG59XG4iXX0=