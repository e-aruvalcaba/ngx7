/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Inject, Injectable, Optional } from '@angular/core';
import { Http } from '@angular/http';
import { Broadcaster } from '@cemex-core/events-v7';
export class FeatureToggleService {
    /**
     * @param {?} eventBroadcaster
     * @param {?} http
     * @param {?} _productPath
     * @param {?} _productEnvironment
     * @param {?} localManifest
     */
    constructor(eventBroadcaster, http, _productPath, _productEnvironment, localManifest) {
        this.eventBroadcaster = eventBroadcaster;
        this.http = http;
        this._productPath = _productPath;
        this._productEnvironment = _productEnvironment;
        this.localManifest = localManifest;
        this.productPath = '';
        this.productEnvironment = '';
        this.productPath = _productPath || '/';
        this.productEnvironment = _productEnvironment || 'development';
        this.getFeatureList(this.localManifest || false);
    }
    /**
     * gets all features
     * @return {?}
     */
    static all() {
        /** @type {?} */
        const result = this.featureList;
        return result;
    }
    /**
     * this method returns either true or false if the list of the features
     * requested is enabled in this environment and for this user
     * @param {?} featureId
     * @param {?=} releaseVersion
     * @param {?=} featureVersion
     * @param {?=} hostName
     * @return {?}
     */
    feature(featureId, releaseVersion, featureVersion, hostName) {
        if (typeof featureId === 'string') {
            return this.coreValidator(featureId, releaseVersion, featureVersion, hostName);
        }
        else {
            featureId.forEach((/**
             * @param {?} singleFeature
             * @return {?}
             */
            singleFeature => {
                if (!this.coreValidator(singleFeature, releaseVersion, featureVersion, hostName)) {
                    return false;
                }
            }));
        }
        return true;
    }
    /**
     * this method returns all list of features
     * @return {?}
     */
    getAll() {
        return FeatureToggleService.featureList;
    }
    /**
     * this method allows to load the feature list from the file
     * @param {?} loadFromLocalList
     * @return {?}
     */
    getFeatureList(loadFromLocalList) {
        // if the loadfromlocallist is true, then load the local-feature.json file
        if (loadFromLocalList) {
            this.http
                .get(this.productPath + 'vendor/local-feature.json')
                .toPromise()
                .then((/**
             * @param {?} response
             * @return {?}
             */
            response => this.populateFeatures(response.json())))
                .catch(this.handleError);
        }
        else {
            // if the API is ready then switch is this one
            this.http
                .get('/feature/api' + this.productPath)
                .toPromise()
                .then((/**
             * @param {?} response
             * @return {?}
             */
            response => this.populateFeatures(response.json())))
                .catch(this.handleError);
        }
    }
    /**
     * @param {?} featureId
     * @param {?=} releaseVersion
     * @param {?=} featureVersion
     * @param {?=} hostName
     * @return {?}
     */
    coreValidator(featureId, releaseVersion, featureVersion, hostName) {
        // todo smaller refactor
        /** @type {?} */
        const localFind = FeatureToggleService.featureList.get(featureId);
        if (localFind === undefined) {
            return false;
        }
        // if it is found then verify against the country
        if (localFind.country !== null && localFind.country !== undefined) {
            // we can take the country from the session storage
            if (window.sessionStorage.getItem('country').indexOf(localFind.country) ===
                -1) {
                return false;
            }
        }
        if (localFind.role !== null && localFind.role !== undefined) {
            /** @type {?} */
            let isRoleAssigned = false;
            /** @type {?} */
            const appsAvailable = JSON.parse(window.sessionStorage.getItem('applications'));
            appsAvailable.forEach((/**
             * @param {?} app
             * @return {?}
             */
            (app) => {
                app.roles.forEach((/**
                 * @param {?} role
                 * @return {?}
                 */
                role => {
                    if (((/** @type {?} */ (role))).roleCode === localFind.role) {
                        isRoleAssigned = true;
                    }
                }));
            }));
            if (!isRoleAssigned) {
                return false;
            }
        }
        if (localFind.role_match !== null && localFind.role_match !== undefined) {
            /** @type {?} */
            let rolesAssigned = 0;
            /** @type {?} */
            const appsAvailable = JSON.parse(window.sessionStorage.getItem('applications'));
            appsAvailable.forEach((/**
             * @param {?} app
             * @return {?}
             */
            (app) => {
                app.roles.forEach((/**
                 * @param {?} role
                 * @return {?}
                 */
                role => {
                    if (localFind.role_match.indexOf(((/** @type {?} */ (role))).roleCode) !== -1) {
                        rolesAssigned = rolesAssigned + 1;
                    }
                }));
            }));
            if (rolesAssigned !== localFind.role_match.split(',').length) {
                return false;
            }
        }
        if (localFind.role_any !== null && localFind.role_any !== undefined) {
            /** @type {?} */
            let rolesAssigned = 0;
            /** @type {?} */
            const appsAvailable = JSON.parse(window.sessionStorage.getItem('applications'));
            appsAvailable.forEach((/**
             * @param {?} app
             * @return {?}
             */
            (app) => {
                app.roles.forEach((/**
                 * @param {?} role
                 * @return {?}
                 */
                role => {
                    if (localFind.role_any.indexOf(((/** @type {?} */ (role))).roleCode) !== -1) {
                        rolesAssigned = rolesAssigned + 1;
                    }
                }));
            }));
            if (rolesAssigned === 0) {
                return false;
            }
        }
        if (localFind.environment !== null && localFind.environment !== undefined) {
            // verify the injection of the environment
            if (localFind.environment !== this.productEnvironment) {
                return false;
            }
        }
        if (localFind.release_version !== null &&
            localFind.release_version !== undefined) {
            // verify the injection of the environment
            if (localFind.release_version !== releaseVersion) {
                return false;
            }
        }
        if (localFind.feature_version !== null &&
            localFind.feature_version !== undefined) {
            // verify the injection of the environment
            if (localFind.feature_version !== featureVersion) {
                return false;
            }
        }
        if (localFind.host_name !== null && localFind.host_name !== undefined) {
            // verify the injection of the environment
            if (localFind.host_name !== hostName) {
                return false;
            }
        }
        return true;
    }
    /**
     * @param {?} error
     * @return {?}
     */
    handleError(error) {
        return Promise.reject(error.message || error);
    }
    /**
     * @param {?} result
     * @return {?}
     */
    populateFeatures(result) {
        for (const item of Object.keys(result)) {
            FeatureToggleService.featureList.set(((/** @type {?} */ (result[item]))).feature, result[item]);
        }
        // this.eventBroadcaster.broadcast(Broadcaster.DCM_LANGUAGE_FETCHED, TranslationService.language);
        // this.onChange(result);
    }
}
FeatureToggleService.featureList = new Map();
FeatureToggleService.language = '';
// Must be set on path constants
FeatureToggleService.PRODUCT_PATH = 'PRODUCT_PATH';
FeatureToggleService.ENVIRONMENT = 'PRODUCT_PATH';
FeatureToggleService.USE_LOCAL_MANIFEST = 'USE_LOCAL_MANIFEST';
FeatureToggleService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
FeatureToggleService.ctorParameters = () => [
    { type: Broadcaster },
    { type: Http },
    { type: String, decorators: [{ type: Inject, args: [FeatureToggleService.PRODUCT_PATH,] }, { type: Optional }] },
    { type: String, decorators: [{ type: Inject, args: [FeatureToggleService.ENVIRONMENT,] }, { type: Optional }] },
    { type: Boolean, decorators: [{ type: Inject, args: [FeatureToggleService.USE_LOCAL_MANIFEST,] }, { type: Optional }] }
];
if (false) {
    /** @type {?} */
    FeatureToggleService.featureList;
    /** @type {?} */
    FeatureToggleService.language;
    /** @type {?} */
    FeatureToggleService.PRODUCT_PATH;
    /** @type {?} */
    FeatureToggleService.ENVIRONMENT;
    /** @type {?} */
    FeatureToggleService.USE_LOCAL_MANIFEST;
    /** @type {?} */
    FeatureToggleService.prototype.productPath;
    /** @type {?} */
    FeatureToggleService.prototype.productEnvironment;
    /** @type {?} */
    FeatureToggleService.prototype.eventBroadcaster;
    /** @type {?} */
    FeatureToggleService.prototype.http;
    /** @type {?} */
    FeatureToggleService.prototype._productPath;
    /** @type {?} */
    FeatureToggleService.prototype._productEnvironment;
    /** @type {?} */
    FeatureToggleService.prototype.localManifest;
}
/**
 * @record
 */
export function IFeatureItem() { }
if (false) {
    /** @type {?} */
    IFeatureItem.prototype.feature;
    /** @type {?} */
    IFeatureItem.prototype.option;
    /** @type {?} */
    IFeatureItem.prototype.environment;
    /** @type {?} */
    IFeatureItem.prototype.role;
    /** @type {?} */
    IFeatureItem.prototype.country;
    /** @type {?} */
    IFeatureItem.prototype.release_version;
    /** @type {?} */
    IFeatureItem.prototype.feature_version;
    /** @type {?} */
    IFeatureItem.prototype.host_name;
    /** @type {?} */
    IFeatureItem.prototype.role_match;
    /** @type {?} */
    IFeatureItem.prototype.role_any;
}
/**
 * @record
 */
export function IApplication() { }
if (false) {
    /** @type {?} */
    IApplication.prototype.applicationCode;
    /** @type {?} */
    IApplication.prototype.applicationId;
    /** @type {?} */
    IApplication.prototype.roles;
}
/**
 * @record
 */
export function IRole() { }
if (false) {
    /** @type {?} */
    IRole.prototype.roleCode;
    /** @type {?} */
    IRole.prototype.roleId;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmVhdHVyZVRvZ2dsZS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGNlbWV4LWNvcmUvYW5ndWxhci1zZXJ2aWNlcy12Ny8iLCJzb3VyY2VzIjpbImxpYi9mZWF0dXJlVG9nZ2xlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM3RCxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXJDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUdwRCxNQUFNLE9BQU8sb0JBQW9COzs7Ozs7OztJQXVCL0IsWUFDUyxnQkFBNkIsRUFDN0IsSUFBVSxFQUdWLFlBQW9CLEVBR3BCLG1CQUEyQixFQUczQixhQUFzQjtRQVZ0QixxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWE7UUFDN0IsU0FBSSxHQUFKLElBQUksQ0FBTTtRQUdWLGlCQUFZLEdBQVosWUFBWSxDQUFRO1FBR3BCLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBUTtRQUczQixrQkFBYSxHQUFiLGFBQWEsQ0FBUztRQXRCeEIsZ0JBQVcsR0FBRyxFQUFFLENBQUM7UUFDakIsdUJBQWtCLEdBQUcsRUFBRSxDQUFDO1FBdUI3QixJQUFJLENBQUMsV0FBVyxHQUFHLFlBQVksSUFBSSxHQUFHLENBQUM7UUFDdkMsSUFBSSxDQUFDLGtCQUFrQixHQUFHLG1CQUFtQixJQUFJLGFBQWEsQ0FBQztRQUMvRCxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxhQUFhLElBQUksS0FBSyxDQUFDLENBQUM7SUFDbkQsQ0FBQzs7Ozs7SUFyQk0sTUFBTSxDQUFDLEdBQUc7O2NBQ1QsTUFBTSxHQUFHLElBQUksQ0FBQyxXQUFXO1FBQy9CLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7Ozs7Ozs7Ozs7SUF1Qk0sT0FBTyxDQUNaLFNBQTRCLEVBQzVC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OztJQVZDLCtCQUFnQjs7SUFDaEIsOEJBQXdCOztJQUN4QixtQ0FBb0I7O0lBQ3BCLDRCQUFhOztJQUNiLCtCQUFnQjs7SUFDaEIsdUNBQXdCOztJQUN4Qix1Q0FBd0I7O0lBQ3hCLGlDQUFrQjs7SUFDbEIsa0NBQW1COztJQUNuQixnQ0FBaUI7Ozs7O0FBRW5CLGtDQUlDOzs7SUFIQyx1Q0FBd0I7O0lBQ3hCLHFDQUFzQjs7SUFDdEIsNkJBQWU7Ozs7O0FBR2pCLDJCQUdDOzs7SUFGQyx5QkFBaUI7O0lBQ2pCLHVCQUFlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0LCBJbmplY3RhYmxlLCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cCB9IGZyb20gJ0Bhbmd1bGFyL2h0dHAnO1xuXG5pbXBvcnQgeyBCcm9hZGNhc3RlciB9IGZyb20gJ0BjZW1leC1jb3JlL2V2ZW50cy12Nyc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBGZWF0dXJlVG9nZ2xlU2VydmljZSB7XG4gIHB1YmxpYyBzdGF0aWMgZmVhdHVyZUxpc3Q6IE1hcDxzdHJpbmcsIElGZWF0dXJlSXRlbT4gPSBuZXcgTWFwPFxuICAgIHN0cmluZyxcbiAgICBJRmVhdHVyZUl0ZW1cbiAgPigpO1xuICBwdWJsaWMgc3RhdGljIGxhbmd1YWdlID0gJyc7XG4gIC8vIE11c3QgYmUgc2V0IG9uIHBhdGggY29uc3RhbnRzXG5cbiAgcHVibGljIHN0YXRpYyBQUk9EVUNUX1BBVEggPSAnUFJPRFVDVF9QQVRIJztcbiAgcHVibGljIHN0YXRpYyBFTlZJUk9OTUVOVCA9ICdQUk9EVUNUX1BBVEgnO1xuICBwdWJsaWMgc3RhdGljIFVTRV9MT0NBTF9NQU5JRkVTVCA9ICdVU0VfTE9DQUxfTUFOSUZFU1QnO1xuXG4gIHB1YmxpYyBwcm9kdWN0UGF0aCA9ICcnO1xuICBwdWJsaWMgcHJvZHVjdEVudmlyb25tZW50ID0gJyc7XG5cbiAgLyoqXG4gICAqIGdldHMgYWxsIGZlYXR1cmVzXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGFsbCgpOiBNYXA8c3RyaW5nLCBJRmVhdHVyZUl0ZW0+IHtcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLmZlYXR1cmVMaXN0O1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgZXZlbnRCcm9hZGNhc3RlcjogQnJvYWRjYXN0ZXIsXG4gICAgcHVibGljIGh0dHA6IEh0dHAsXG4gICAgQEluamVjdChGZWF0dXJlVG9nZ2xlU2VydmljZS5QUk9EVUNUX1BBVEgpXG4gICAgQE9wdGlvbmFsKClcbiAgICBwdWJsaWMgX3Byb2R1Y3RQYXRoOiBzdHJpbmcsXG4gICAgQEluamVjdChGZWF0dXJlVG9nZ2xlU2VydmljZS5FTlZJUk9OTUVOVClcbiAgICBAT3B0aW9uYWwoKVxuICAgIHB1YmxpYyBfcHJvZHVjdEVudmlyb25tZW50OiBzdHJpbmcsXG4gICAgQEluamVjdChGZWF0dXJlVG9nZ2xlU2VydmljZS5VU0VfTE9DQUxfTUFOSUZFU1QpXG4gICAgQE9wdGlvbmFsKClcbiAgICBwdWJsaWMgbG9jYWxNYW5pZmVzdDogYm9vbGVhblxuICApIHtcbiAgICB0aGlzLnByb2R1Y3RQYXRoID0gX3Byb2R1Y3RQYXRoIHx8ICcvJztcbiAgICB0aGlzLnByb2R1Y3RFbnZpcm9ubWVudCA9IF9wcm9kdWN0RW52aXJvbm1lbnQgfHwgJ2RldmVsb3BtZW50JztcbiAgICB0aGlzLmdldEZlYXR1cmVMaXN0KHRoaXMubG9jYWxNYW5pZmVzdCB8fCBmYWxzZSk7XG4gIH1cbiAgLyoqXG4gICAqIHRoaXMgbWV0aG9kIHJldHVybnMgZWl0aGVyIHRydWUgb3IgZmFsc2UgaWYgdGhlIGxpc3Qgb2YgdGhlIGZlYXR1cmVzXG4gICAqIHJlcXVlc3RlZCBpcyBlbmFibGVkIGluIHRoaXMgZW52aXJvbm1lbnQgYW5kIGZvciB0aGlzIHVzZXJcbiAgICovXG4gIHB1YmxpYyBmZWF0dXJlKFxuICAgIGZlYXR1cmVJZDogc3RyaW5nIHwgc3RyaW5nW10sXG4gICAgcmVsZWFzZVZlcnNpb24/OiBzdHJpbmcsXG4gICAgZmVhdHVyZVZlcnNpb24/OiBzdHJpbmcsXG4gICAgaG9zdE5hbWU/OiBzdHJpbmdcbiAgKTogYm9vbGVhbiB7XG4gICAgaWYgKHR5cGVvZiBmZWF0dXJlSWQgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb3JlVmFsaWRhdG9yKFxuICAgICAgICBmZWF0dXJlSWQsXG4gICAgICAgIHJlbGVhc2VWZXJzaW9uLFxuICAgICAgICBmZWF0dXJlVmVyc2lvbixcbiAgICAgICAgaG9zdE5hbWVcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZlYXR1cmVJZC5mb3JFYWNoKHNpbmdsZUZlYXR1cmUgPT4ge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgIXRoaXMuY29yZVZhbGlkYXRvcihcbiAgICAgICAgICAgIHNpbmdsZUZlYXR1cmUsXG4gICAgICAgICAgICByZWxlYXNlVmVyc2lvbixcbiAgICAgICAgICAgIGZlYXR1cmVWZXJzaW9uLFxuICAgICAgICAgICAgaG9zdE5hbWVcbiAgICAgICAgICApXG4gICAgICAgICkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIHRoaXMgbWV0aG9kIHJldHVybnMgYWxsIGxpc3Qgb2YgZmVhdHVyZXNcbiAgICovXG4gIHB1YmxpYyBnZXRBbGwoKTogTWFwPHN0cmluZywgSUZlYXR1cmVJdGVtPiB7XG4gICAgcmV0dXJuIEZlYXR1cmVUb2dnbGVTZXJ2aWNlLmZlYXR1cmVMaXN0O1xuICB9XG4gIC8qKlxuICAgKiB0aGlzIG1ldGhvZCBhbGxvd3MgdG8gbG9hZCB0aGUgZmVhdHVyZSBsaXN0IGZyb20gdGhlIGZpbGVcbiAgICovXG4gIHB1YmxpYyBnZXRGZWF0dXJlTGlzdChsb2FkRnJvbUxvY2FsTGlzdDogYm9vbGVhbik6IHZvaWQge1xuICAgIC8vIGlmIHRoZSBsb2FkZnJvbWxvY2FsbGlzdCBpcyB0cnVlLCB0aGVuIGxvYWQgdGhlIGxvY2FsLWZlYXR1cmUuanNvbiBmaWxlXG4gICAgaWYgKGxvYWRGcm9tTG9jYWxMaXN0KSB7XG4gICAgICB0aGlzLmh0dHBcbiAgICAgICAgLmdldCh0aGlzLnByb2R1Y3RQYXRoICsgJ3ZlbmRvci9sb2NhbC1mZWF0dXJlLmpzb24nKVxuICAgICAgICAudG9Qcm9taXNlKClcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gdGhpcy5wb3B1bGF0ZUZlYXR1cmVzKHJlc3BvbnNlLmpzb24oKSkpXG4gICAgICAgIC5jYXRjaCh0aGlzLmhhbmRsZUVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gaWYgdGhlIEFQSSBpcyByZWFkeSB0aGVuIHN3aXRjaCBpcyB0aGlzIG9uZVxuICAgICAgdGhpcy5odHRwXG4gICAgICAgIC5nZXQoJy9mZWF0dXJlL2FwaScgKyB0aGlzLnByb2R1Y3RQYXRoKVxuICAgICAgICAudG9Qcm9taXNlKClcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gdGhpcy5wb3B1bGF0ZUZlYXR1cmVzKHJlc3BvbnNlLmpzb24oKSkpXG4gICAgICAgIC5jYXRjaCh0aGlzLmhhbmRsZUVycm9yKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgY29yZVZhbGlkYXRvcihcbiAgICBmZWF0dXJlSWQ6IHN0cmluZyxcbiAgICByZWxlYXNlVmVyc2lvbj86IHN0cmluZyxcbiAgICBmZWF0dXJlVmVyc2lvbj86IHN0cmluZyxcbiAgICBob3N0TmFtZT86IHN0cmluZ1xuICApOiBib29sZWFuIHtcbiAgICAvLyB0b2RvIHNtYWxsZXIgcmVmYWN0b3JcbiAgICBjb25zdCBsb2NhbEZpbmQ6IElGZWF0dXJlSXRlbSA9IEZlYXR1cmVUb2dnbGVTZXJ2aWNlLmZlYXR1cmVMaXN0LmdldChcbiAgICAgIGZlYXR1cmVJZFxuICAgICk7XG4gICAgaWYgKGxvY2FsRmluZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIGlmIGl0IGlzIGZvdW5kIHRoZW4gdmVyaWZ5IGFnYWluc3QgdGhlIGNvdW50cnlcbiAgICBpZiAobG9jYWxGaW5kLmNvdW50cnkgIT09IG51bGwgJiYgbG9jYWxGaW5kLmNvdW50cnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gd2UgY2FuIHRha2UgdGhlIGNvdW50cnkgZnJvbSB0aGUgc2Vzc2lvbiBzdG9yYWdlXG4gICAgICBpZiAoXG4gICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdjb3VudHJ5JykuaW5kZXhPZihsb2NhbEZpbmQuY291bnRyeSkgPT09XG4gICAgICAgIC0xXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAobG9jYWxGaW5kLnJvbGUgIT09IG51bGwgJiYgbG9jYWxGaW5kLnJvbGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgbGV0IGlzUm9sZUFzc2lnbmVkID0gZmFsc2U7XG4gICAgICBjb25zdCBhcHBzQXZhaWxhYmxlID0gSlNPTi5wYXJzZShcbiAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ2FwcGxpY2F0aW9ucycpXG4gICAgICApO1xuICAgICAgYXBwc0F2YWlsYWJsZS5mb3JFYWNoKChhcHA6IElBcHBsaWNhdGlvbikgPT4ge1xuICAgICAgICBhcHAucm9sZXMuZm9yRWFjaChyb2xlID0+IHtcbiAgICAgICAgICBpZiAoKHJvbGUgYXMgSVJvbGUpLnJvbGVDb2RlID09PSBsb2NhbEZpbmQucm9sZSkge1xuICAgICAgICAgICAgaXNSb2xlQXNzaWduZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIGlmICghaXNSb2xlQXNzaWduZWQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAobG9jYWxGaW5kLnJvbGVfbWF0Y2ggIT09IG51bGwgJiYgbG9jYWxGaW5kLnJvbGVfbWF0Y2ggIT09IHVuZGVmaW5lZCkge1xuICAgICAgbGV0IHJvbGVzQXNzaWduZWQgPSAwO1xuICAgICAgY29uc3QgYXBwc0F2YWlsYWJsZSA9IEpTT04ucGFyc2UoXG4gICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdhcHBsaWNhdGlvbnMnKVxuICAgICAgKTtcbiAgICAgIGFwcHNBdmFpbGFibGUuZm9yRWFjaCgoYXBwOiBJQXBwbGljYXRpb24pID0+IHtcbiAgICAgICAgYXBwLnJvbGVzLmZvckVhY2gocm9sZSA9PiB7XG4gICAgICAgICAgaWYgKGxvY2FsRmluZC5yb2xlX21hdGNoLmluZGV4T2YoKHJvbGUgYXMgSVJvbGUpLnJvbGVDb2RlKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHJvbGVzQXNzaWduZWQgPSByb2xlc0Fzc2lnbmVkICsgMTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBpZiAocm9sZXNBc3NpZ25lZCAhPT0gbG9jYWxGaW5kLnJvbGVfbWF0Y2guc3BsaXQoJywnKS5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAobG9jYWxGaW5kLnJvbGVfYW55ICE9PSBudWxsICYmIGxvY2FsRmluZC5yb2xlX2FueSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBsZXQgcm9sZXNBc3NpZ25lZCA9IDA7XG4gICAgICBjb25zdCBhcHBzQXZhaWxhYmxlID0gSlNPTi5wYXJzZShcbiAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ2FwcGxpY2F0aW9ucycpXG4gICAgICApO1xuICAgICAgYXBwc0F2YWlsYWJsZS5mb3JFYWNoKChhcHA6IElBcHBsaWNhdGlvbikgPT4ge1xuICAgICAgICBhcHAucm9sZXMuZm9yRWFjaChyb2xlID0+IHtcbiAgICAgICAgICBpZiAobG9jYWxGaW5kLnJvbGVfYW55LmluZGV4T2YoKHJvbGUgYXMgSVJvbGUpLnJvbGVDb2RlKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHJvbGVzQXNzaWduZWQgPSByb2xlc0Fzc2lnbmVkICsgMTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBpZiAocm9sZXNBc3NpZ25lZCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChsb2NhbEZpbmQuZW52aXJvbm1lbnQgIT09IG51bGwgJiYgbG9jYWxGaW5kLmVudmlyb25tZW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIHZlcmlmeSB0aGUgaW5qZWN0aW9uIG9mIHRoZSBlbnZpcm9ubWVudFxuICAgICAgaWYgKGxvY2FsRmluZC5lbnZpcm9ubWVudCAhPT0gdGhpcy5wcm9kdWN0RW52aXJvbm1lbnQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoXG4gICAgICBsb2NhbEZpbmQucmVsZWFzZV92ZXJzaW9uICE9PSBudWxsICYmXG4gICAgICBsb2NhbEZpbmQucmVsZWFzZV92ZXJzaW9uICE9PSB1bmRlZmluZWRcbiAgICApIHtcbiAgICAgIC8vIHZlcmlmeSB0aGUgaW5qZWN0aW9uIG9mIHRoZSBlbnZpcm9ubWVudFxuICAgICAgaWYgKGxvY2FsRmluZC5yZWxlYXNlX3ZlcnNpb24gIT09IHJlbGVhc2VWZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKFxuICAgICAgbG9jYWxGaW5kLmZlYXR1cmVfdmVyc2lvbiAhPT0gbnVsbCAmJlxuICAgICAgbG9jYWxGaW5kLmZlYXR1cmVfdmVyc2lvbiAhPT0gdW5kZWZpbmVkXG4gICAgKSB7XG4gICAgICAvLyB2ZXJpZnkgdGhlIGluamVjdGlvbiBvZiB0aGUgZW52aXJvbm1lbnRcbiAgICAgIGlmIChsb2NhbEZpbmQuZmVhdHVyZV92ZXJzaW9uICE9PSBmZWF0dXJlVmVyc2lvbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChsb2NhbEZpbmQuaG9zdF9uYW1lICE9PSBudWxsICYmIGxvY2FsRmluZC5ob3N0X25hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gdmVyaWZ5IHRoZSBpbmplY3Rpb24gb2YgdGhlIGVudmlyb25tZW50XG4gICAgICBpZiAobG9jYWxGaW5kLmhvc3RfbmFtZSAhPT0gaG9zdE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHB1YmxpYyBoYW5kbGVFcnJvcihlcnJvcjogYW55KTogUHJvbWlzZTxhbnk+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IubWVzc2FnZSB8fCBlcnJvcik7XG4gIH1cblxuICBwdWJsaWMgcG9wdWxhdGVGZWF0dXJlcyhyZXN1bHQpIHtcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgT2JqZWN0LmtleXMocmVzdWx0KSkge1xuICAgICAgRmVhdHVyZVRvZ2dsZVNlcnZpY2UuZmVhdHVyZUxpc3Quc2V0KFxuICAgICAgICAocmVzdWx0W2l0ZW1dIGFzIElGZWF0dXJlSXRlbSkuZmVhdHVyZSxcbiAgICAgICAgcmVzdWx0W2l0ZW1dXG4gICAgICApO1xuICAgIH1cbiAgICAvLyB0aGlzLmV2ZW50QnJvYWRjYXN0ZXIuYnJvYWRjYXN0KEJyb2FkY2FzdGVyLkRDTV9MQU5HVUFHRV9GRVRDSEVELCBUcmFuc2xhdGlvblNlcnZpY2UubGFuZ3VhZ2UpO1xuICAgIC8vIHRoaXMub25DaGFuZ2UocmVzdWx0KTtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElGZWF0dXJlSXRlbSB7XG4gIGZlYXR1cmU6IHN0cmluZztcbiAgb3B0aW9uOiBzdHJpbmcgfCBudW1iZXI7XG4gIGVudmlyb25tZW50OiBzdHJpbmc7XG4gIHJvbGU6IHN0cmluZztcbiAgY291bnRyeTogc3RyaW5nO1xuICByZWxlYXNlX3ZlcnNpb246IHN0cmluZztcbiAgZmVhdHVyZV92ZXJzaW9uOiBzdHJpbmc7XG4gIGhvc3RfbmFtZTogc3RyaW5nO1xuICByb2xlX21hdGNoOiBzdHJpbmc7XG4gIHJvbGVfYW55OiBzdHJpbmc7XG59XG5leHBvcnQgaW50ZXJmYWNlIElBcHBsaWNhdGlvbiB7XG4gIGFwcGxpY2F0aW9uQ29kZTogc3RyaW5nO1xuICBhcHBsaWNhdGlvbklkOiBudW1iZXI7XG4gIHJvbGVzOiBJUm9sZVtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElSb2xlIHtcbiAgcm9sZUNvZGU6IHN0cmluZztcbiAgcm9sZUlkOiBudW1iZXI7XG59XG4iXX0=