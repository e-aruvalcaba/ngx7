/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, Input, ElementRef, ContentChildren, QueryList, HostBinding } from '@angular/core';
import { Table } from '../../classes/table.class';
import { CmxRowTemplateDirective } from '../../directives/cmx-row-template.directive';
import { CmxHeaderTemplateDirective } from '../../directives/cmx-header-template.directive';
import { CmxHeaderCellComponent } from '../cmx-header-cell/cmx-header-cell.component';
import { RowPlaceholderDirective } from '../../directives/cmx-row-placeholder.directive';
import { HeaderPlaceholderDirective } from '../../directives/cmx-header-placeholder.directive';
import { WatcherService } from '../../services/watcher.service';
/**
 * @record
 */
export function Page() { }
if (false) {
    /** @type {?} */
    Page.prototype.pageNumber;
    /** @type {?} */
    Page.prototype.minIndex;
    /** @type {?} */
    Page.prototype.maxIndex;
}
export class CmxTableComponent {
    /**
     * @param {?} watcher
     */
    constructor(watcher) {
        this.watcher = watcher;
        this.cmxTableClass = true;
        this.pages = [];
        this.tableHasScroll = false;
        this._dataSource = [];
        this._pageSize = 30;
        this._rtl = false;
        this.currentActivePage = 1;
        this.currentPageData = [];
        this.viewportData = [];
        this.activeFiltersCopy = [];
        this.rowViewReferences = [];
    }
    /**
     * @return {?}
     */
    get tableSource() {
        return this._table;
    }
    /**
     * @param {?} $value
     * @return {?}
     */
    set tableSource($value) {
        if ($value !== undefined && $value !== null && $value instanceof Table) {
            this._table = $value;
            this.renderHeader();
        }
    }
    /**
     * @return {?}
     */
    get dataSource() {
        return this._dataSource;
    }
    /**
     * @param {?} $value
     * @return {?}
     */
    set dataSource($value) {
        if ($value !== undefined && $value !== null) {
            this._dataSource = $value;
            this.viewportData = $value;
            this.rowViewReferences = [];
            this.initialize();
        }
        else {
            this._dataSource = [];
        }
    }
    /**
     * @param {?} $value
     * @return {?}
     */
    set updateDataSource($value) {
        if ($value !== undefined && $value !== null) {
            this._dataSource = $value;
            this.viewportData = $value;
            this.rowViewReferences = [];
            this.updateDataTable();
        }
        else {
            this._dataSource = [];
        }
    }
    /**
     * @return {?}
     */
    get pageSize() {
        return this._pageSize;
    }
    /**
     * @param {?} $value
     * @return {?}
     */
    set pageSize($value) {
        if ($value !== undefined && $value !== null) {
            this._pageSize = $value;
            this.calculateNumberOfPages();
            this.setPageData();
        }
    }
    /**
     * @return {?}
     */
    get rtl() {
        return this._rtl;
    }
    /**
     * @param {?} $value
     * @return {?}
     */
    set rtl($value) {
        if ($value !== undefined && $value !== null) {
            this._rtl = $value;
        }
    }
    /**
     * @return {?}
     */
    ngAfterContentInit() {
        this.renderHeader();
        this.assignedId = this.watcher.createSubject();
        this.activeFiltersSubscription = this.watcher.listenToActiveFilters(this.assignedId)
            .subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        ($event) => {
            if ($event.length > 0) {
                this.activeFiltersCopy = $event;
                // there are filters to apply
                this.viewportData = this.filterData($event);
            }
            else {
                this.activeFiltersCopy = [];
                // no filters to apply
                this.viewportData = this._dataSource;
            }
            this.currentActivePage = 1;
            this.calculateNumberOfPages();
            this.setPageData();
        }));
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.rowPlaceholder.viewContainerReference.clear();
        this.headerPlaceholder.viewContainerReference.clear();
        this.activeFiltersSubscription.unsubscribe();
    }
    /**
     * returns the items including filters applied in table
     * Author: Andres Santos
     * @return {?}
     */
    filteredItems() {
        return this.viewportData;
    }
    /**
     * returns the items including filters applied in current page
     * Author: Andres Santos
     * @return {?}
     */
    filteredItemsInPage() {
        return this.currentPageData;
    }
    /**
     * @return {?}
     */
    clearActiveFilters() {
        this.watcher.clearActiveFilters();
    }
    /**
     * returns the current active filters
     * Author: Antonio Vargas
     * @return {?}
     */
    getActiveFiltersCopy() {
        return this.activeFiltersCopy;
    }
    /**
     * Triggers the filtering of data
     * @param {?} $activeFilters
     * @return {?}
     */
    triggerFilter($activeFilters) {
        if ($activeFilters.length > 0) {
            // there are filters to apply
            this.viewportData = this.filterData($activeFilters);
        }
        else {
            // no filters to apply
            this.viewportData = this._dataSource;
        }
        this.calculateNumberOfPages();
        this.setPageData();
    }
    /**
     * \@description Resets the table visualization.
     * @return {?}
     */
    reset() {
        this.currentActivePage = 1;
        this.rowViewReferences = [];
        this.initialize();
    }
    /**
     * @param {?} activeFilters
     * @return {?}
     */
    filterData(activeFilters) {
        /** @type {?} */
        let result = this._dataSource;
        /** @type {?} */
        const data = this._dataSource;
        /** @type {?} */
        let aux = [];
        /** @type {?} */
        const filtered = [];
        activeFilters.forEach((/**
         * @param {?} $filter
         * @return {?}
         */
        ($filter) => {
            filtered[$filter.columnKey] = [];
        }));
        activeFilters.forEach((/**
         * @param {?} $filter
         * @param {?} $index
         * @return {?}
         */
        ($filter, $index) => {
            aux = data.filter(this._table.getColumn($filter.columnKey).getFilterFunction($filter));
            filtered[$filter.columnKey] = filtered[$filter.columnKey].concat(aux);
        }));
        for (const $key of Object.keys(filtered)) {
            result = this.findIntersection(result, filtered[$key]);
        }
        return result;
    }
    /**
     * @param {?} columnId
     * @param {?} ASC
     * @return {?}
     */
    sortData(columnId, ASC) {
        this.viewportData = this.viewportData.sort(this._table.getColumn(columnId).getSortFunction(ASC));
        this.calculateNumberOfPages();
        this.setPageData();
    }
    /**
     * \@description Apply the current active filters in the table
     * @return {?}
     */
    applyCurrentFilters() {
        if (this.activeFiltersCopy.length > 0) {
            this.viewportData = this.filterData(this.activeFiltersCopy);
        }
        else {
            this.viewportData = this._dataSource;
        }
        this.calculateNumberOfPages();
        this.setPageData();
    }
    /**
     * \@description Overwrite the active filters with new ones to apply
     * @param {?} $filters
     * @return {?}
     */
    applyNewFilters($filters) {
        if ($filters && $filters.length > 0) {
            this.viewportData = this.filterData($filters);
        }
        else {
            this.viewportData = this._dataSource;
        }
        this.calculateNumberOfPages();
        this.setPageData();
    }
    /**
     * @param {?} $currentPage
     * @return {?}
     */
    setCurrentPage($currentPage) {
        this.currentActivePage = $currentPage;
        this.setPageData();
    }
    /**
     * @private
     * @return {?}
     */
    initialize() {
        this.rowPlaceholder.viewContainerReference.clear();
        this.headerPlaceholder.viewContainerReference.clear();
        this.renderHeader();
        this.calculateNumberOfPages();
        this.setPageData();
    }
    /**
     * @private
     * @return {?}
     */
    updateDataTable() {
        this.rowPlaceholder.viewContainerReference.clear();
        this.calculateNumberOfPages();
        this.setPageData();
    }
    /**
     * @private
     * @return {?}
     */
    checkIfTableHasScroll() {
        if (this.cmxTableBodyElement &&
            this.cmxTableBodyElement.nativeElement.offsetHeight <
                this.cmxTableBodyElement.nativeElement.scrollHeight) {
            this.tableHasScroll = true;
        }
        else {
            this.tableHasScroll = false;
        }
    }
    // =============================================================================================
    // views' rendering
    // =============================================================================================
    /**
     * @private
     * @return {?}
     */
    renderHeader() {
        this.headerPlaceholder.viewContainerReference.clear();
        if (this.headerDefinitions) {
            this.headerDefinitions.forEach((/**
             * @param {?} headerDef
             * @return {?}
             */
            (headerDef) => {
                /** @type {?} */
                const context = { $implicit: this._table };
                this.headerPlaceholder.viewContainerReference.createEmbeddedView(headerDef.template, context);
            }));
        }
    }
    /**
     * @private
     * @return {?}
     */
    renderRows() {
        if (this.rowDefinitions) {
            if (this.rowViewReferences && this.rowViewReferences.length > 0) {
                // the views already exist
                this.updateRowsContext();
            }
            else {
                // first rendering of the rows
                this.rowDefinitions.forEach((/**
                 * @param {?} rowDef
                 * @return {?}
                 */
                (rowDef) => {
                    this.currentPageData.forEach((/**
                     * @param {?} rowData
                     * @param {?} $index
                     * @return {?}
                     */
                    (rowData, $index) => {
                        /** @type {?} */
                        const context = { $implicit: rowData };
                        /** @type {?} */
                        const ref = this.rowPlaceholder.viewContainerReference.createEmbeddedView(rowDef.template, context);
                        this.rowViewReferences.push(ref);
                    }));
                }));
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    updateRowsContext() {
        if (this.rowDefinitions) {
            this.rowDefinitions.forEach((/**
             * @param {?} rowDef
             * @return {?}
             */
            (rowDef) => {
                this.rowViewReferences.forEach((/**
                 * @param {?} viewRef
                 * @param {?} $index
                 * @return {?}
                 */
                (viewRef, $index) => {
                    if ($index > (this.currentPageData.length - 1)) {
                        // the current page has less data to show than the set page size
                        if (viewRef !== undefined) {
                            viewRef.destroy();
                        }
                        this.rowViewReferences.splice($index, 1, undefined);
                    }
                    else {
                        // the view reference is used on the current page
                        /** @type {?} */
                        const context = { $implicit: this.currentPageData[$index] };
                        if (viewRef === undefined) {
                            // the view reference was destroyed, a new replacement
                            /** @type {?} */
                            const ref = this.rowPlaceholder.viewContainerReference
                                .createEmbeddedView(rowDef.template, context, $index);
                            this.rowViewReferences[$index] = ref;
                        }
                        else {
                            // no new view reference is required, update the context data
                            viewRef.context.$implicit = context.$implicit;
                        }
                    }
                }));
            }));
        }
    }
    // =============================================================================================
    // filters
    // =============================================================================================
    /**
     * @private
     * @param {?} arrayOne
     * @param {?} arrayTwo
     * @return {?}
     */
    findIntersection(arrayOne, arrayTwo) {
        /** @type {?} */
        const intersection = [];
        /** @type {?} */
        let $i = 0;
        /** @type {?} */
        let $j = 0;
        while ($i < arrayOne.length) {
            $j = 0;
            while ($j < arrayTwo.length) {
                if (arrayOne[$i] === arrayTwo[$j]) {
                    intersection.push(arrayOne[$i]);
                }
                $j++;
            }
            $i++;
        }
        return intersection;
    }
    // =============================================================================================
    // pagination
    // =============================================================================================
    /**
     * \@description Calculates the number of pages given the array of data and
     * determines the index of the data source for each page.
     * @private
     * @return {?}
     */
    calculateNumberOfPages() {
        /** @type {?} */
        const numberOfPages = Math.ceil(this.viewportData.length / this._pageSize);
        this.pages = [];
        /** @type {?} */
        let i = 1;
        do {
            /** @type {?} */
            const min = ((i - 1) * this._pageSize);
            /** @type {?} */
            const max = min + this._pageSize - 1;
            this.pages.push((/** @type {?} */ ({
                pageNumber: i,
                minIndex: min,
                maxIndex: max
            })));
            i++;
        } while (i <= numberOfPages);
    }
    /**
     * @private
     * @return {?}
     */
    setPageData() {
        /** @type {?} */
        const $page = this.pages.find((/**
         * @param {?} page
         * @return {?}
         */
        (page) => page.pageNumber === this.currentActivePage));
        this.currentPageData = [];
        if ($page !== undefined && $page !== null) {
            for (let $i = $page.minIndex; $i <= $page.maxIndex; $i++) {
                if (this.viewportData[$i]) {
                    this.currentPageData.push(this.viewportData[$i]);
                }
            }
        }
        else {
            this.currentActivePage = 1;
            for (let $i = this.pages[0].minIndex; $i <= this.pages[0].maxIndex; $i++) {
                if (this.viewportData[$i]) {
                    this.currentPageData.push(this.viewportData[$i]);
                }
            }
        }
        this.renderRows();
        this.checkIfTableHasScroll();
    }
}
CmxTableComponent.decorators = [
    { type: Component, args: [{
                selector: 'cmx-table',
                template: "<div class=\"cmx-table-header\" [class.--scroll-spacing]=\"tableHasScroll\">\r\n    <ng-container headerPlaceholder></ng-container>\r\n</div>\r\n<div #cmxTableBody class=\"cmx-table-body\">\r\n    <ng-container rowPlaceholder></ng-container>\r\n</div>\r\n<div *ngIf=\"pages.length > 1\" style=\"text-align: center;\">\r\n    <cmx-pagination [pages]=\"pages.length\" [currentPage]=\"currentActivePage\"\r\n    (pageChanged)=\"setCurrentPage($event)\"></cmx-pagination>\r\n</div>",
                styles: ["@import url(https://www.cemexgo.com/cdn/cmx-dls-icons.css);.roboto-bold{font-weight:700}.roboto-medium{font-weight:500}.roboto-regular{font-weight:400}.roboto-light{font-weight:300}.roboto-thin{font-weight:100}.h1-role,h1{font-family:Roboto,sans-serif;font-size:3rem;line-height:3rem;font-weight:700;color:#001b3a}.h2-role,.h3-role,h2,h3{font-family:Roboto,sans-serif;font-size:1.625rem;line-height:2rem;font-weight:400;color:#001b3a}.h4-role,h4{font-family:Roboto,sans-serif;font-size:2rem;line-height:2rem;font-weight:500;color:#001b3a}.h5-role,h5{font-family:Roboto,sans-serif;font-size:1.25rem;line-height:1.5rem;font-weight:400;color:#001b3a}.h6-role,h6{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem;font-weight:700;color:#001b3a;text-transform:uppercase}.table-entry{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem}.table-entry-strong{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem;color:#333;font-weight:700}.link,.table-entry,a{text-decoration:none;color:#3fa9f5}a:hover{text-decoration:underline}.input-placeholder{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem;color:#666}.input-text{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem;color:#333}.size-15{font-size:.9375rem}.size-24{font-size:1.5rem}.text-left{text-align:left!important}.text-right{text-align:right!important}.text-center{text-align:center!important}.flex-first{order:-1}.flex-last{order:1}.flex-unordered{order:0}.flex-row{flex-direction:row!important}.flex-column{flex-direction:column!important}.flex-row-reverse{flex-direction:row-reverse!important}.flex-column-reverse{flex-direction:column-reverse!important}.flex-wrap{flex-wrap:wrap!important}.flex-nowrap{flex-wrap:nowrap!important}.flex-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-start{justify-content:flex-start!important}.justify-content-end{justify-content:flex-end!important}.justify-content-center{justify-content:center!important}.justify-content-between{justify-content:space-between!important}.justify-content-around{justify-content:space-around!important}.align-items-start{align-items:flex-start!important}.align-items-end{align-items:flex-end!important}.align-items-center{align-items:center!important}.align-items-baseline{align-items:baseline!important}.align-items-stretch{align-items:stretch!important}.align-content-start{align-content:flex-start!important}.align-content-end{align-content:flex-end!important}.align-content-center{align-content:center!important}.align-content-between{align-content:space-between!important}.align-content-around{align-content:space-around!important}.align-content-stretch{align-content:stretch!important}.align-self-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-start{align-self:flex-start!important}.align-self-end{align-self:flex-end!important}.align-self-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-baseline{align-self:baseline!important}.align-self-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}@media (min-width:576px){.text-xs-left{text-align:left!important}.text-xs-right{text-align:right!important}.text-xs-center{text-align:center!important}.flex-xs-first{order:-1}.flex-xs-last{order:1}.flex-xs-unordered{order:0}.flex-xs-row{flex-direction:row!important}.flex-xs-column{flex-direction:column!important}.flex-xs-row-reverse{flex-direction:row-reverse!important}.flex-xs-column-reverse{flex-direction:column-reverse!important}.flex-xs-wrap{flex-wrap:wrap!important}.flex-xs-nowrap{flex-wrap:nowrap!important}.flex-xs-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-xs-start{justify-content:flex-start!important}.justify-content-xs-end{justify-content:flex-end!important}.justify-content-xs-center{justify-content:center!important}.justify-content-xs-between{justify-content:space-between!important}.justify-content-xs-around{justify-content:space-around!important}.align-items-xs-start{align-items:flex-start!important}.align-items-xs-end{align-items:flex-end!important}.align-items-xs-center{align-items:center!important}.align-items-xs-baseline{align-items:baseline!important}.align-items-xs-stretch{align-items:stretch!important}.align-content-xs-start{align-content:flex-start!important}.align-content-xs-end{align-content:flex-end!important}.align-content-xs-center{align-content:center!important}.align-content-xs-between{align-content:space-between!important}.align-content-xs-around{align-content:space-around!important}.align-content-xs-stretch{align-content:stretch!important}.align-self-xs-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-xs-start{align-self:flex-start!important}.align-self-xs-end{align-self:flex-end!important}.align-self-xs-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-xs-baseline{align-self:baseline!important}.align-self-xs-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}@media (min-width:768px){.text-sm-left{text-align:left!important}.text-sm-right{text-align:right!important}.text-sm-center{text-align:center!important}.flex-sm-first{order:-1}.flex-sm-last{order:1}.flex-sm-unordered{order:0}.flex-sm-row{flex-direction:row!important}.flex-sm-column{flex-direction:column!important}.flex-sm-row-reverse{flex-direction:row-reverse!important}.flex-sm-column-reverse{flex-direction:column-reverse!important}.flex-sm-wrap{flex-wrap:wrap!important}.flex-sm-nowrap{flex-wrap:nowrap!important}.flex-sm-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-sm-start{justify-content:flex-start!important}.justify-content-sm-end{justify-content:flex-end!important}.justify-content-sm-center{justify-content:center!important}.justify-content-sm-between{justify-content:space-between!important}.justify-content-sm-around{justify-content:space-around!important}.align-items-sm-start{align-items:flex-start!important}.align-items-sm-end{align-items:flex-end!important}.align-items-sm-center{align-items:center!important}.align-items-sm-baseline{align-items:baseline!important}.align-items-sm-stretch{align-items:stretch!important}.align-content-sm-start{align-content:flex-start!important}.align-content-sm-end{align-content:flex-end!important}.align-content-sm-center{align-content:center!important}.align-content-sm-between{align-content:space-between!important}.align-content-sm-around{align-content:space-around!important}.align-content-sm-stretch{align-content:stretch!important}.align-self-sm-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-sm-start{align-self:flex-start!important}.align-self-sm-end{align-self:flex-end!important}.align-self-sm-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-sm-baseline{align-self:baseline!important}.align-self-sm-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}@media (min-width:1080px){.text-md-left{text-align:left!important}.text-md-right{text-align:right!important}.text-md-center{text-align:center!important}.flex-md-first{order:-1}.flex-md-last{order:1}.flex-md-unordered{order:0}.flex-md-row{flex-direction:row!important}.flex-md-column{flex-direction:column!important}.flex-md-row-reverse{flex-direction:row-reverse!important}.flex-md-column-reverse{flex-direction:column-reverse!important}.flex-md-wrap{flex-wrap:wrap!important}.flex-md-nowrap{flex-wrap:nowrap!important}.flex-md-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-md-start{justify-content:flex-start!important}.justify-content-md-end{justify-content:flex-end!important}.justify-content-md-center{justify-content:center!important}.justify-content-md-between{justify-content:space-between!important}.justify-content-md-around{justify-content:space-around!important}.align-items-md-start{align-items:flex-start!important}.align-items-md-end{align-items:flex-end!important}.align-items-md-center{align-items:center!important}.align-items-md-baseline{align-items:baseline!important}.align-items-md-stretch{align-items:stretch!important}.align-content-md-start{align-content:flex-start!important}.align-content-md-end{align-content:flex-end!important}.align-content-md-center{align-content:center!important}.align-content-md-between{align-content:space-between!important}.align-content-md-around{align-content:space-around!important}.align-content-md-stretch{align-content:stretch!important}.align-self-md-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-md-start{align-self:flex-start!important}.align-self-md-end{align-self:flex-end!important}.align-self-md-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-md-baseline{align-self:baseline!important}.align-self-md-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}@media (min-width:1320px){.text-lg-left{text-align:left!important}.text-lg-right{text-align:right!important}.text-lg-center{text-align:center!important}.flex-lg-first{order:-1}.flex-lg-last{order:1}.flex-lg-unordered{order:0}.flex-lg-row{flex-direction:row!important}.flex-lg-column{flex-direction:column!important}.flex-lg-row-reverse{flex-direction:row-reverse!important}.flex-lg-column-reverse{flex-direction:column-reverse!important}.flex-lg-wrap{flex-wrap:wrap!important}.flex-lg-nowrap{flex-wrap:nowrap!important}.flex-lg-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-lg-start{justify-content:flex-start!important}.justify-content-lg-end{justify-content:flex-end!important}.justify-content-lg-center{justify-content:center!important}.justify-content-lg-between{justify-content:space-between!important}.justify-content-lg-around{justify-content:space-around!important}.align-items-lg-start{align-items:flex-start!important}.align-items-lg-end{align-items:flex-end!important}.align-items-lg-center{align-items:center!important}.align-items-lg-baseline{align-items:baseline!important}.align-items-lg-stretch{align-items:stretch!important}.align-content-lg-start{align-content:flex-start!important}.align-content-lg-end{align-content:flex-end!important}.align-content-lg-center{align-content:center!important}.align-content-lg-between{align-content:space-between!important}.align-content-lg-around{align-content:space-around!important}.align-content-lg-stretch{align-content:stretch!important}.align-self-lg-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-lg-start{align-self:flex-start!important}.align-self-lg-end{align-self:flex-end!important}.align-self-lg-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-lg-baseline{align-self:baseline!important}.align-self-lg-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}@media (min-width:1560px){.text-xlg-left{text-align:left!important}.text-xlg-right{text-align:right!important}.text-xlg-center{text-align:center!important}.flex-xlg-first{order:-1}.flex-xlg-last{order:1}.flex-xlg-unordered{order:0}.flex-xlg-row{flex-direction:row!important}.flex-xlg-column{flex-direction:column!important}.flex-xlg-row-reverse{flex-direction:row-reverse!important}.flex-xlg-column-reverse{flex-direction:column-reverse!important}.flex-xlg-wrap{flex-wrap:wrap!important}.flex-xlg-nowrap{flex-wrap:nowrap!important}.flex-xlg-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-xlg-start{justify-content:flex-start!important}.justify-content-xlg-end{justify-content:flex-end!important}.justify-content-xlg-center{justify-content:center!important}.justify-content-xlg-between{justify-content:space-between!important}.justify-content-xlg-around{justify-content:space-around!important}.align-items-xlg-start{align-items:flex-start!important}.align-items-xlg-end{align-items:flex-end!important}.align-items-xlg-center{align-items:center!important}.align-items-xlg-baseline{align-items:baseline!important}.align-items-xlg-stretch{align-items:stretch!important}.align-content-xlg-start{align-content:flex-start!important}.align-content-xlg-end{align-content:flex-end!important}.align-content-xlg-center{align-content:center!important}.align-content-xlg-between{align-content:space-between!important}.align-content-xlg-around{align-content:space-around!important}.align-content-xlg-stretch{align-content:stretch!important}.align-self-xlg-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-xlg-start{align-self:flex-start!important}.align-self-xlg-end{align-self:flex-end!important}.align-self-xlg-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-xlg-baseline{align-self:baseline!important}.align-self-xlg-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}:host{font-family:Roboto,sans-serif;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}:host.cmx-table{display:block}.table-container{position:relative;width:100%;height:100%;background-color:#f4f6f9;display:block}.cmx-table-header{text-decoration:none;font-size:.75rem;line-height:20px;color:#001b3a;display:block;border-collapse:collapse;margin-bottom:4px;padding:10px 0;width:100%;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.cmx-table-header.--scroll-spacing{padding-right:2.5vh;padding-left:0}html[dir=rtl] :host .cmx-table-header{padding-left:10px}.cmx-table-body{display:block;padding:0;background-color:none;margin-bottom:16px;overflow-x:hidden}.--truncate-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%;min-width:0}:host::ng-deep .cmx-table-item{border-collapse:collapse;margin-bottom:4px;padding:8px 0;height:40px;width:100%;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;border-top:2px solid #f4f6f9;border-bottom:2px solid #f4f6f9;background-color:#fff;transition:background-color .5s ease-out;-moz-transition:background-color .5s ease-out;-webkit-transition:background-color .5s ease-out}:host::ng-deep .cmx-table-item.checked{background-color:#b7deff!important}:host::ng-deep .cmx-table-item:hover{background-color:#d6d6d6}:host::ng-deep .cmx-table-item:nth-child(even){background-color:#e8ebef}:host::ng-deep .cmx-table-item:nth-child(even):hover{background-color:#d6d6d6}:host::ng-deep .cmx-cell{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding-left:12px;padding-right:12px;color:#333;font-family:Roboto,sans-serif;font-size:.75rem;line-height:.75rem}:host::ng-deep .status{width:24px;height:16px;border-radius:2px;margin-right:8px;background-color:#d6d6d6}:host::ng-deep .status.ok{background-color:#7ac943}:host::ng-deep .status.warning{background-color:#f9a23d}:host::ng-deep .status.error{background-color:#c0392b}.pagination{display:inline-block;list-style:none;padding:0;margin:0}.pagination li{display:inline-block;margin:0 8px;float:left}.pagination li a{cursor:pointer;font-size:.875rem;line-height:22px;width:24px;height:24px;display:inline-block;color:#5c6570;float:left;text-decoration:none;border-radius:2px;text-align:center;border:1px solid transparent}.pagination li a.hover,.pagination li a:hover{border:1px solid #3fa9f5}.pagination li a.current{color:#fff;background:#3fa9f5}.pagination li svg{width:8px;height:12px;fill:#3fa9f5;transition:.25s}.pagination .pagination-next.hide,.pagination .pagination-prev.hide{display:none}.pagination .pagination-next.hover a,.pagination .pagination-next:hover a,.pagination .pagination-prev.hover a,.pagination .pagination-prev:hover a{border:0}.pagination .pagination-next.hover a svg,.pagination .pagination-next:hover a svg,.pagination .pagination-prev.hover a svg,.pagination .pagination-prev:hover a svg{width:16px;height:20px;fill:#3fa9f5}"]
            }] }
];
/** @nocollapse */
CmxTableComponent.ctorParameters = () => [
    { type: WatcherService }
];
CmxTableComponent.propDecorators = {
    tableSource: [{ type: Input }],
    dataSource: [{ type: Input }],
    updateDataSource: [{ type: Input }],
    pageSize: [{ type: Input }],
    rtl: [{ type: Input }],
    cmxTableClass: [{ type: HostBinding, args: ['class.cmx-table',] }],
    rowDefinitions: [{ type: ContentChildren, args: [CmxRowTemplateDirective,] }],
    headerDefinitions: [{ type: ContentChildren, args: [CmxHeaderTemplateDirective,] }],
    headerCells: [{ type: ContentChildren, args: [CmxHeaderCellComponent, { descendants: true },] }],
    rowPlaceholder: [{ type: ViewChild, args: [RowPlaceholderDirective,] }],
    headerPlaceholder: [{ type: ViewChild, args: [HeaderPlaceholderDirective,] }],
    cmxTableBodyElement: [{ type: ViewChild, args: ['cmxTableBody',] }]
};
if (false) {
    /** @type {?} */
    CmxTableComponent.prototype.cmxTableClass;
    /** @type {?} */
    CmxTableComponent.prototype.rowDefinitions;
    /** @type {?} */
    CmxTableComponent.prototype.headerDefinitions;
    /** @type {?} */
    CmxTableComponent.prototype.headerCells;
    /** @type {?} */
    CmxTableComponent.prototype.rowPlaceholder;
    /** @type {?} */
    CmxTableComponent.prototype.headerPlaceholder;
    /** @type {?} */
    CmxTableComponent.prototype.cmxTableBodyElement;
    /** @type {?} */
    CmxTableComponent.prototype.assignedId;
    /** @type {?} */
    CmxTableComponent.prototype.pages;
    /** @type {?} */
    CmxTableComponent.prototype.tableHasScroll;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype._dataSource;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype._table;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype._pageSize;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype._rtl;
    /** @type {?} */
    CmxTableComponent.prototype.currentActivePage;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype.currentPageData;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype.viewportData;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype.activeFiltersCopy;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype.activeFiltersSubscription;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype.rowViewReferences;
    /**
     * @type {?}
     * @private
     */
    CmxTableComponent.prototype.watcher;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY214LXRhYmxlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BjZW1leC9jbXgtdGFibGUtdjcvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9jbXgtdGFibGUvY214LXRhYmxlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUNILFNBQVMsRUFHVCxTQUFTLEVBQ1QsS0FBSyxFQUNMLFVBQVUsRUFDVixlQUFlLEVBQ2YsU0FBUyxFQUVULFdBQVcsRUFDZCxNQUFNLGVBQWUsQ0FBQztBQUl2QixPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDbEQsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sNkNBQTZDLENBQUM7QUFDdEYsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sZ0RBQWdELENBQUM7QUFDNUYsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sOENBQThDLENBQUM7QUFDdEYsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sZ0RBQWdELENBQUM7QUFDekYsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sbURBQW1ELENBQUM7QUFFL0YsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGdDQUFnQyxDQUFDOzs7O0FBRWhFLDBCQUlDOzs7SUFIRywwQkFBbUI7O0lBQ25CLHdCQUFpQjs7SUFDakIsd0JBQWlCOztBQVFyQixNQUFNLE9BQU8saUJBQWlCOzs7O0lBcUYxQixZQUFvQixPQUF1QjtRQUF2QixZQUFPLEdBQVAsT0FBTyxDQUFnQjtRQTFCSixrQkFBYSxHQUFHLElBQUksQ0FBQztRQVlyRCxVQUFLLEdBQVcsRUFBRSxDQUFDO1FBQ25CLG1CQUFjLEdBQUcsS0FBSyxDQUFDO1FBRXRCLGdCQUFXLEdBQVUsRUFBRSxDQUFDO1FBRXhCLGNBQVMsR0FBRyxFQUFFLENBQUM7UUFDZixTQUFJLEdBQUcsS0FBSyxDQUFDO1FBQ2Qsc0JBQWlCLEdBQUcsQ0FBQyxDQUFD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QUM1RCwyQ0FDMEQ7O0lBQzFELDhDQUNnRTs7SUFDaEUsd0NBQ3NEOztJQUN0RCwyQ0FBbUY7O0lBQ25GLDhDQUE0Rjs7SUFDNUYsZ0RBQWtFOztJQUVsRSx1Q0FBMEI7O0lBQzFCLGtDQUEwQjs7SUFDMUIsMkNBQThCOzs7OztJQUU5Qix3Q0FBZ0M7Ozs7O0lBQ2hDLG1DQUFzQjs7Ozs7SUFDdEIsc0NBQXVCOzs7OztJQUN2QixpQ0FBcUI7O0lBQ3JCLDhDQUE2Qjs7Ozs7SUFDN0IsNENBQW9DOzs7OztJQUNwQyx5Q0FBaUM7Ozs7O0lBQ2pDLDhDQUF5Qzs7Ozs7SUFDekMsc0RBQWdEOzs7OztJQUNoRCw4Q0FBNEQ7Ozs7O0lBRWhELG9DQUErQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsXHJcbiAgICBPbkRlc3Ryb3ksXHJcbiAgICBBZnRlckNvbnRlbnRJbml0LFxyXG4gICAgVmlld0NoaWxkLFxyXG4gICAgSW5wdXQsXHJcbiAgICBFbGVtZW50UmVmLFxyXG4gICAgQ29udGVudENoaWxkcmVuLFxyXG4gICAgUXVlcnlMaXN0LFxyXG4gICAgRW1iZWRkZWRWaWV3UmVmLFxyXG4gICAgSG9zdEJpbmRpbmdcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5cclxuaW1wb3J0IHsgVGFibGUgfSBmcm9tICcuLi8uLi9jbGFzc2VzL3RhYmxlLmNsYXNzJztcclxuaW1wb3J0IHsgQ214Um93VGVtcGxhdGVEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL2NteC1yb3ctdGVtcGxhdGUuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgQ214SGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL2NteC1oZWFkZXItdGVtcGxhdGUuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgQ214SGVhZGVyQ2VsbENvbXBvbmVudCB9IGZyb20gJy4uL2NteC1oZWFkZXItY2VsbC9jbXgtaGVhZGVyLWNlbGwuY29tcG9uZW50JztcclxuaW1wb3J0IHsgUm93UGxhY2Vob2xkZXJEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL2NteC1yb3ctcGxhY2Vob2xkZXIuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgSGVhZGVyUGxhY2Vob2xkZXJEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL2NteC1oZWFkZXItcGxhY2Vob2xkZXIuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgRmlsdGVyIH0gZnJvbSAnLi4vLi4vY2xhc3Nlcy9maWx0ZXIuY2xhc3MnO1xyXG5pbXBvcnQgeyBXYXRjaGVyU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3dhdGNoZXIuc2VydmljZSc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBhZ2Uge1xyXG4gICAgcGFnZU51bWJlcjogbnVtYmVyO1xyXG4gICAgbWluSW5kZXg6IG51bWJlcjtcclxuICAgIG1heEluZGV4OiBudW1iZXI7XHJcbn1cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdjbXgtdGFibGUnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2NteC10YWJsZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsgJy4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vc2Nzcy9jbXgtdGFibGUvdjEvY214LXRhYmxlLmNvbXBvbmVudC5zY3NzJyBdLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgQ214VGFibGVDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlckNvbnRlbnRJbml0LCBPbkRlc3Ryb3kge1xyXG4gICAgQElucHV0KClcclxuICAgIGdldCB0YWJsZVNvdXJjZSgpOiBUYWJsZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RhYmxlO1xyXG4gICAgfVxyXG4gICAgc2V0IHRhYmxlU291cmNlKCR2YWx1ZTogVGFibGUpIHtcclxuICAgICAgICBpZiAoJHZhbHVlICE9PSB1bmRlZmluZWQgJiYgJHZhbHVlICE9PSBudWxsICYmICR2YWx1ZSBpbnN0YW5jZW9mIFRhYmxlICkge1xyXG4gICAgICAgICAgICB0aGlzLl90YWJsZSA9ICR2YWx1ZTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJIZWFkZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKVxyXG4gICAgZ2V0IGRhdGFTb3VyY2UoKTogYW55W10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhU291cmNlO1xyXG4gICAgfVxyXG4gICAgc2V0IGRhdGFTb3VyY2UoJHZhbHVlOiBhbnlbXSkge1xyXG4gICAgICAgIGlmICgkdmFsdWUgIT09IHVuZGVmaW5lZCAmJiAkdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9ICR2YWx1ZTtcclxuICAgICAgICAgICAgdGhpcy52aWV3cG9ydERhdGEgPSAkdmFsdWU7XHJcbiAgICAgICAgICAgIHRoaXMucm93Vmlld1JlZmVyZW5jZXMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHVwZGF0ZURhdGFTb3VyY2UoJHZhbHVlOiBhbnlbXSkge1xyXG4gICAgICAgIGlmICgkdmFsdWUgIT09IHVuZGVmaW5lZCAmJiAkdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9ICR2YWx1ZTtcclxuICAgICAgICAgICAgdGhpcy52aWV3cG9ydERhdGEgPSAkdmFsdWU7XHJcbiAgICAgICAgICAgIHRoaXMucm93Vmlld1JlZmVyZW5jZXMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhVGFibGUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9kYXRhU291cmNlID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBnZXQgcGFnZVNpemUoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcGFnZVNpemU7XHJcbiAgICB9XHJcbiAgICBzZXQgcGFnZVNpemUoJHZhbHVlOiBudW1iZXIpIHtcclxuICAgICAgICBpZiAoJHZhbHVlICE9PSB1bmRlZmluZWQgJiYgJHZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BhZ2VTaXplID0gJHZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU51bWJlck9mUGFnZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRQYWdlRGF0YSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIEBJbnB1dCgpXHJcbiAgICBnZXQgcnRsKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9ydGw7XHJcbiAgICB9XHJcbiAgICBzZXQgcnRsKCR2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgICAgIGlmICgkdmFsdWUgIT09IHVuZGVmaW5lZCAmJiAkdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fcnRsID0gJHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmNteC10YWJsZScpIHB1YmxpYyBjbXhUYWJsZUNsYXNzID0gdHJ1ZTtcclxuICAgIEBDb250ZW50Q2hpbGRyZW4oQ214Um93VGVtcGxhdGVEaXJlY3RpdmUpXHJcbiAgICBwdWJsaWMgcm93RGVmaW5pdGlvbnM6IFF1ZXJ5TGlzdDxDbXhSb3dUZW1wbGF0ZURpcmVjdGl2ZT47XHJcbiAgICBAQ29udGVudENoaWxkcmVuKENteEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlKVxyXG4gICAgcHVibGljIGhlYWRlckRlZmluaXRpb25zOiBRdWVyeUxpc3Q8Q214SGVhZGVyVGVtcGxhdGVEaXJlY3RpdmU+O1xyXG4gICAgQENvbnRlbnRDaGlsZHJlbihDbXhIZWFkZXJDZWxsQ29tcG9uZW50LCB7ZGVzY2VuZGFudHM6IHRydWV9KVxyXG4gICAgcHVibGljIGhlYWRlckNlbGxzOiBRdWVyeUxpc3Q8Q214SGVhZGVyQ2VsbENvbXBvbmVudD47XHJcbiAgICBAVmlld0NoaWxkKFJvd1BsYWNlaG9sZGVyRGlyZWN0aXZlKSBwdWJsaWMgcm93UGxhY2Vob2xkZXI6IFJvd1BsYWNlaG9sZGVyRGlyZWN0aXZlO1xyXG4gICAgQFZpZXdDaGlsZChIZWFkZXJQbGFjZWhvbGRlckRpcmVjdGl2ZSkgcHVibGljIGhlYWRlclBsYWNlaG9sZGVyOiBIZWFkZXJQbGFjZWhvbGRlckRpcmVjdGl2ZTtcclxuICAgIEBWaWV3Q2hpbGQoJ2NteFRhYmxlQm9keScpIHB1YmxpYyBjbXhUYWJsZUJvZHlFbGVtZW50OiBFbGVtZW50UmVmO1xyXG5cclxuICAgIHB1YmxpYyBhc3NpZ25lZElkOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgcGFnZXM6IFBhZ2VbXSA9IFtdO1xyXG4gICAgcHVibGljIHRhYmxlSGFzU2Nyb2xsID0gZmFsc2U7XHJcblxyXG4gICAgcHJpdmF0ZSBfZGF0YVNvdXJjZTogYW55W10gPSBbXTtcclxuICAgIHByaXZhdGUgX3RhYmxlOiBUYWJsZTtcclxuICAgIHByaXZhdGUgX3BhZ2VTaXplID0gMzA7XHJcbiAgICBwcml2YXRlIF9ydGwgPSBmYWxzZTtcclxuICAgIHB1YmxpYyBjdXJyZW50QWN0aXZlUGFnZSA9IDE7XHJcbiAgICBwcml2YXRlIGN1cnJlbnRQYWdlRGF0YTogYW55W10gPSBbXTtcclxuICAgIHByaXZhdGUgdmlld3BvcnREYXRhOiBhbnlbXSA9IFtdO1xyXG4gICAgcHJpdmF0ZSBhY3RpdmVGaWx0ZXJzQ29weTogRmlsdGVyW10gPSBbXTtcclxuICAgIHByaXZhdGUgYWN0aXZlRmlsdGVyc1N1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSByb3dWaWV3UmVmZXJlbmNlczogQXJyYXk8RW1iZWRkZWRWaWV3UmVmPGFueT4+ID0gW107XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB3YXRjaGVyOiBXYXRjaGVyU2VydmljZSkgeyB9XHJcblxyXG4gICAgcHVibGljIG5nQWZ0ZXJDb250ZW50SW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnJlbmRlckhlYWRlcigpO1xyXG4gICAgICAgIHRoaXMuYXNzaWduZWRJZCA9IHRoaXMud2F0Y2hlci5jcmVhdGVTdWJqZWN0KCk7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVGaWx0ZXJzU3Vic2NyaXB0aW9uID0gdGhpcy53YXRjaGVyLmxpc3RlblRvQWN0aXZlRmlsdGVycyh0aGlzLmFzc2lnbmVkSWQpXHJcbiAgICAgICAgLnN1YnNjcmliZSgoJGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICgkZXZlbnQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVGaWx0ZXJzQ29weSA9ICRldmVudDtcclxuICAgICAgICAgICAgICAgIC8vIHRoZXJlIGFyZSBmaWx0ZXJzIHRvIGFwcGx5XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdwb3J0RGF0YSA9IHRoaXMuZmlsdGVyRGF0YSggJGV2ZW50ICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUZpbHRlcnNDb3B5ID0gW107XHJcbiAgICAgICAgICAgICAgICAvLyBubyBmaWx0ZXJzIHRvIGFwcGx5XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdwb3J0RGF0YSA9IHRoaXMuX2RhdGFTb3VyY2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50QWN0aXZlUGFnZSA9IDE7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlTnVtYmVyT2ZQYWdlcygpO1xyXG4gICAgICAgICAgICB0aGlzLnNldFBhZ2VEYXRhKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucm93UGxhY2Vob2xkZXIudmlld0NvbnRhaW5lclJlZmVyZW5jZS5jbGVhcigpO1xyXG4gICAgICAgIHRoaXMuaGVhZGVyUGxhY2Vob2xkZXIudmlld0NvbnRhaW5lclJlZmVyZW5jZS5jbGVhcigpO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlRmlsdGVyc1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogcmV0dXJucyB0aGUgaXRlbXMgaW5jbHVkaW5nIGZpbHRlcnMgYXBwbGllZCBpbiB0YWJsZVxyXG4gICAgICogQXV0aG9yOiBBbmRyZXMgU2FudG9zXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBmaWx0ZXJlZEl0ZW1zKCk6IGFueVtdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3cG9ydERhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiByZXR1cm5zIHRoZSBpdGVtcyBpbmNsdWRpbmcgZmlsdGVycyBhcHBsaWVkIGluIGN1cnJlbnQgcGFnZVxyXG4gICAgICogQXV0aG9yOiBBbmRyZXMgU2FudG9zXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBmaWx0ZXJlZEl0ZW1zSW5QYWdlKCk6IGFueVtdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50UGFnZURhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsZWFyQWN0aXZlRmlsdGVycygpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLndhdGNoZXIuY2xlYXJBY3RpdmVGaWx0ZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiByZXR1cm5zIHRoZSBjdXJyZW50IGFjdGl2ZSBmaWx0ZXJzXHJcbiAgICAgKiBBdXRob3I6IEFudG9uaW8gVmFyZ2FzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRBY3RpdmVGaWx0ZXJzQ29weSgpOiBGaWx0ZXJbXSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlRmlsdGVyc0NvcHk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUcmlnZ2VycyB0aGUgZmlsdGVyaW5nIG9mIGRhdGFcclxuICAgICAqL1xyXG4gICAgcHVibGljIHRyaWdnZXJGaWx0ZXIoICRhY3RpdmVGaWx0ZXJzOiBGaWx0ZXJbXSApOiB2b2lkIHtcclxuICAgICAgICBpZiAoICRhY3RpdmVGaWx0ZXJzLmxlbmd0aCA+IDAgKSB7XHJcbiAgICAgICAgICAgIC8vIHRoZXJlIGFyZSBmaWx0ZXJzIHRvIGFwcGx5XHJcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnREYXRhID0gdGhpcy5maWx0ZXJEYXRhKCAkYWN0aXZlRmlsdGVycyApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIG5vIGZpbHRlcnMgdG8gYXBwbHlcclxuICAgICAgICAgICAgdGhpcy52aWV3cG9ydERhdGEgPSB0aGlzLl9kYXRhU291cmNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNhbGN1bGF0ZU51bWJlck9mUGFnZXMoKTtcclxuICAgICAgICB0aGlzLnNldFBhZ2VEYXRhKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb24gUmVzZXRzIHRoZSB0YWJsZSB2aXN1YWxpemF0aW9uLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVzZXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50QWN0aXZlUGFnZSA9IDE7XHJcbiAgICAgICAgdGhpcy5yb3dWaWV3UmVmZXJlbmNlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBmaWx0ZXJEYXRhKCBhY3RpdmVGaWx0ZXJzOiBGaWx0ZXJbXSApOiBhbnlbXSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdDogYW55W10gPSB0aGlzLl9kYXRhU291cmNlO1xyXG4gICAgICAgIGNvbnN0IGRhdGE6IGFueVtdID0gdGhpcy5fZGF0YVNvdXJjZTtcclxuICAgICAgICBsZXQgYXV4OiBhbnlbXSA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkOiB7IFsgaW5kZXg6IHN0cmluZyBdOiBhbnkgfSA9IFtdO1xyXG4gICAgICAgIGFjdGl2ZUZpbHRlcnMuZm9yRWFjaCggKCAkZmlsdGVyICkgPT4ge1xyXG4gICAgICAgICAgICBmaWx0ZXJlZFsgJGZpbHRlci5jb2x1bW5LZXkgXSA9IFtdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGFjdGl2ZUZpbHRlcnMuZm9yRWFjaCggKCAkZmlsdGVyLCAkaW5kZXggKSA9PiB7XHJcbiAgICAgICAgICAgIGF1eCA9IGRhdGEuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGFibGUuZ2V0Q29sdW1uKCAkZmlsdGVyLmNvbHVtbktleSApLmdldEZpbHRlckZ1bmN0aW9uKCAkZmlsdGVyIClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgZmlsdGVyZWRbICRmaWx0ZXIuY29sdW1uS2V5IF0gPSBmaWx0ZXJlZFsgJGZpbHRlci5jb2x1bW5LZXkgXS5jb25jYXQoIGF1eCApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZvciAoIGNvbnN0ICRrZXkgb2YgT2JqZWN0LmtleXMoIGZpbHRlcmVkICkgKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuZmluZEludGVyc2VjdGlvbiggcmVzdWx0LCBmaWx0ZXJlZFsgJGtleSBdICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNvcnREYXRhKCBjb2x1bW5JZDogc3RyaW5nLCBBU0M6IGJvb2xlYW4gKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy52aWV3cG9ydERhdGEgPSB0aGlzLnZpZXdwb3J0RGF0YS5zb3J0KFxyXG4gICAgICAgICAgICB0aGlzLl90YWJsZS5nZXRDb2x1bW4oIGNvbHVtbklkICkuZ2V0U29ydEZ1bmN0aW9uKCBBU0MgKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVOdW1iZXJPZlBhZ2VzKCk7XHJcbiAgICAgICAgdGhpcy5zZXRQYWdlRGF0YSgpO1xyXG4gICAgfVxyXG5cclxuICAgLyoqXHJcbiAgICAqIEBkZXNjcmlwdGlvbiBBcHBseSB0aGUgY3VycmVudCBhY3RpdmUgZmlsdGVycyBpbiB0aGUgdGFibGVcclxuICAgICovXHJcbiAgICBwdWJsaWMgYXBwbHlDdXJyZW50RmlsdGVycygpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5hY3RpdmVGaWx0ZXJzQ29weS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnREYXRhID0gdGhpcy5maWx0ZXJEYXRhKHRoaXMuYWN0aXZlRmlsdGVyc0NvcHkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnREYXRhID0gdGhpcy5fZGF0YVNvdXJjZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVOdW1iZXJPZlBhZ2VzKCk7XHJcbiAgICAgICAgdGhpcy5zZXRQYWdlRGF0YSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIE92ZXJ3cml0ZSB0aGUgYWN0aXZlIGZpbHRlcnMgd2l0aCBuZXcgb25lcyB0byBhcHBseVxyXG4gICAgICogQHBhcmFtICAkZmlsdGVyczogYXJyYXk8RmlsdGVyPlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXBwbHlOZXdGaWx0ZXJzKCRmaWx0ZXJzOiBGaWx0ZXJbXSk6IHZvaWQge1xyXG4gICAgICAgIGlmICgkZmlsdGVycyAmJiAkZmlsdGVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnREYXRhID0gdGhpcy5maWx0ZXJEYXRhKCRmaWx0ZXJzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXdwb3J0RGF0YSA9IHRoaXMuX2RhdGFTb3VyY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2FsY3VsYXRlTnVtYmVyT2ZQYWdlcygpO1xyXG4gICAgICAgIHRoaXMuc2V0UGFnZURhdGEoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0Q3VycmVudFBhZ2UoJGN1cnJlbnRQYWdlOiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRBY3RpdmVQYWdlID0gJGN1cnJlbnRQYWdlO1xyXG4gICAgICAgIHRoaXMuc2V0UGFnZURhdGEoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGluaXRpYWxpemUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yb3dQbGFjZWhvbGRlci52aWV3Q29udGFpbmVyUmVmZXJlbmNlLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy5oZWFkZXJQbGFjZWhvbGRlci52aWV3Q29udGFpbmVyUmVmZXJlbmNlLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJIZWFkZXIoKTtcclxuICAgICAgICB0aGlzLmNhbGN1bGF0ZU51bWJlck9mUGFnZXMoKTtcclxuICAgICAgICB0aGlzLnNldFBhZ2VEYXRhKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVEYXRhVGFibGUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yb3dQbGFjZWhvbGRlci52aWV3Q29udGFpbmVyUmVmZXJlbmNlLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVOdW1iZXJPZlBhZ2VzKCk7XHJcbiAgICAgICAgdGhpcy5zZXRQYWdlRGF0YSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2hlY2tJZlRhYmxlSGFzU2Nyb2xsKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICggdGhpcy5jbXhUYWJsZUJvZHlFbGVtZW50ICYmXHJcbiAgICAgICAgdGhpcy5jbXhUYWJsZUJvZHlFbGVtZW50Lm5hdGl2ZUVsZW1lbnQub2Zmc2V0SGVpZ2h0IDxcclxuICAgICAgICB0aGlzLmNteFRhYmxlQm9keUVsZW1lbnQubmF0aXZlRWxlbWVudC5zY3JvbGxIZWlnaHQgKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFibGVIYXNTY3JvbGwgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFibGVIYXNTY3JvbGwgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICAvLyB2aWV3cycgcmVuZGVyaW5nXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiAgICBwcml2YXRlIHJlbmRlckhlYWRlcigpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmhlYWRlclBsYWNlaG9sZGVyLnZpZXdDb250YWluZXJSZWZlcmVuY2UuY2xlYXIoKTtcclxuICAgICAgICBpZiAoIHRoaXMuaGVhZGVyRGVmaW5pdGlvbnMgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyRGVmaW5pdGlvbnMuZm9yRWFjaCggKCBoZWFkZXJEZWYgKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZXh0ID0geyAkaW1wbGljaXQ6IHRoaXMuX3RhYmxlIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhlYWRlclBsYWNlaG9sZGVyLnZpZXdDb250YWluZXJSZWZlcmVuY2UuY3JlYXRlRW1iZWRkZWRWaWV3KFxyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlckRlZi50ZW1wbGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZW5kZXJSb3dzKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICggdGhpcy5yb3dEZWZpbml0aW9ucyApIHtcclxuICAgICAgICAgICAgaWYgKCB0aGlzLnJvd1ZpZXdSZWZlcmVuY2VzICYmIHRoaXMucm93Vmlld1JlZmVyZW5jZXMubGVuZ3RoID4gMCApIHtcclxuICAgICAgICAgICAgICAgIC8vIHRoZSB2aWV3cyBhbHJlYWR5IGV4aXN0XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJvd3NDb250ZXh0KCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBmaXJzdCByZW5kZXJpbmcgb2YgdGhlIHJvd3NcclxuICAgICAgICAgICAgICAgIHRoaXMucm93RGVmaW5pdGlvbnMuZm9yRWFjaCggKCByb3dEZWYgKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZURhdGEuZm9yRWFjaCggKCByb3dEYXRhLCAkaW5kZXggKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSB7ICRpbXBsaWNpdDogcm93RGF0YSB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWYgPSB0aGlzLnJvd1BsYWNlaG9sZGVyLnZpZXdDb250YWluZXJSZWZlcmVuY2UuY3JlYXRlRW1iZWRkZWRWaWV3KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93RGVmLnRlbXBsYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvd1ZpZXdSZWZlcmVuY2VzLnB1c2goIHJlZiApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVSb3dzQ29udGV4dCgpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIHRoaXMucm93RGVmaW5pdGlvbnMgKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm93RGVmaW5pdGlvbnMuZm9yRWFjaCggKCByb3dEZWYgKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJvd1ZpZXdSZWZlcmVuY2VzLmZvckVhY2goICggdmlld1JlZiwgJGluZGV4ICkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICggJGluZGV4ID4gKCB0aGlzLmN1cnJlbnRQYWdlRGF0YS5sZW5ndGggLSAxICkgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBjdXJyZW50IHBhZ2UgaGFzIGxlc3MgZGF0YSB0byBzaG93IHRoYW4gdGhlIHNldCBwYWdlIHNpemVcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB2aWV3UmVmICE9PSB1bmRlZmluZWQgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3UmVmLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvd1ZpZXdSZWZlcmVuY2VzLnNwbGljZSggJGluZGV4LCAxLCB1bmRlZmluZWQgKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgdmlldyByZWZlcmVuY2UgaXMgdXNlZCBvbiB0aGUgY3VycmVudCBwYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSB7ICRpbXBsaWNpdDogdGhpcy5jdXJyZW50UGFnZURhdGFbICRpbmRleCBdIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggdmlld1JlZiA9PT0gdW5kZWZpbmVkICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHZpZXcgcmVmZXJlbmNlIHdhcyBkZXN0cm95ZWQsIGEgbmV3IHJlcGxhY2VtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWYgPSB0aGlzLnJvd1BsYWNlaG9sZGVyLnZpZXdDb250YWluZXJSZWZlcmVuY2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jcmVhdGVFbWJlZGRlZFZpZXcoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93RGVmLnRlbXBsYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3dWaWV3UmVmZXJlbmNlc1sgJGluZGV4IF0gPSByZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBubyBuZXcgdmlldyByZWZlcmVuY2UgaXMgcmVxdWlyZWQsIHVwZGF0ZSB0aGUgY29udGV4dCBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3UmVmLmNvbnRleHQuJGltcGxpY2l0ID0gY29udGV4dC4kaW1wbGljaXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gZmlsdGVyc1xyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4gICAgcHJpdmF0ZSBmaW5kSW50ZXJzZWN0aW9uKCBhcnJheU9uZTogYW55W10sIGFycmF5VHdvOiBhbnlbXSApOiBhbnlbXSB7XHJcbiAgICAgICAgY29uc3QgaW50ZXJzZWN0aW9uOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgIGxldCAkaSA9IDA7XHJcbiAgICAgICAgbGV0ICRqID0gMDtcclxuICAgICAgICB3aGlsZSAoICRpIDwgYXJyYXlPbmUubGVuZ3RoICkge1xyXG4gICAgICAgICAgICAkaiA9IDA7XHJcbiAgICAgICAgICAgIHdoaWxlICggJGogPCBhcnJheVR3by5sZW5ndGggKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIGFycmF5T25lWyAkaSBdID09PSBhcnJheVR3b1sgJGogXSApIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnRlcnNlY3Rpb24ucHVzaCggYXJyYXlPbmVbICRpIF0gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRqKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJGkrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGludGVyc2VjdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgIC8vIHBhZ2luYXRpb25cclxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGRlc2NyaXB0aW9uIENhbGN1bGF0ZXMgdGhlIG51bWJlciBvZiBwYWdlcyBnaXZlbiB0aGUgYXJyYXkgb2YgZGF0YSBhbmRcclxuICAgICAqIGRldGVybWluZXMgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHNvdXJjZSBmb3IgZWFjaCBwYWdlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNhbGN1bGF0ZU51bWJlck9mUGFnZXMoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgbnVtYmVyT2ZQYWdlczogbnVtYmVyID0gTWF0aC5jZWlsKCB0aGlzLnZpZXdwb3J0RGF0YS5sZW5ndGggLyB0aGlzLl9wYWdlU2l6ZSApO1xyXG4gICAgICAgIHRoaXMucGFnZXMgPSBbXTtcclxuICAgICAgICBsZXQgaSA9IDE7XHJcbiAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICBjb25zdCBtaW4gPSAoICggaSAtIDEgKSAqIHRoaXMuX3BhZ2VTaXplICk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1heCA9IG1pbiArIHRoaXMuX3BhZ2VTaXplIC0gMTtcclxuICAgICAgICAgICAgdGhpcy5wYWdlcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHBhZ2VOdW1iZXI6IGksXHJcbiAgICAgICAgICAgICAgICBtaW5JbmRleDogbWluLFxyXG4gICAgICAgICAgICAgICAgbWF4SW5kZXg6IG1heFxyXG4gICAgICAgICAgICB9IGFzIFBhZ2UpO1xyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgfSB3aGlsZSAoIGkgPD0gbnVtYmVyT2ZQYWdlcyApO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0UGFnZURhdGEoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgJHBhZ2UgPSB0aGlzLnBhZ2VzLmZpbmQoKHBhZ2UpID0+IHBhZ2UucGFnZU51bWJlciA9PT0gdGhpcy5jdXJyZW50QWN0aXZlUGFnZSk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50UGFnZURhdGEgPSBbXTtcclxuICAgICAgICBpZiAoJHBhZ2UgIT09IHVuZGVmaW5lZCAmJiAkcGFnZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCAkaSA9ICRwYWdlLm1pbkluZGV4OyAkaSA8PSAkcGFnZS5tYXhJbmRleDsgJGkrKyApIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZpZXdwb3J0RGF0YVskaV0pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlRGF0YS5wdXNoKHRoaXMudmlld3BvcnREYXRhWyRpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRBY3RpdmVQYWdlID0gMTtcclxuICAgICAgICAgICAgZm9yIChsZXQgJGkgPSB0aGlzLnBhZ2VzWzBdLm1pbkluZGV4OyAkaSA8PSB0aGlzLnBhZ2VzWzBdLm1heEluZGV4OyAkaSsrICkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmlld3BvcnREYXRhWyRpXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VEYXRhLnB1c2godGhpcy52aWV3cG9ydERhdGFbJGldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlbmRlclJvd3MoKTtcclxuICAgICAgICB0aGlzLmNoZWNrSWZUYWJsZUhhc1Njcm9sbCgpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==