/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, HostBinding, ContentChild, Host, Renderer2, ViewChild, ElementRef } from '@angular/core';
import { CmxCheckboxFiltersComponent } from '../cmx-checkbox-filters/cmx-checkbox-filters.component';
import { CmxDatepickerFilterComponent } from '../cmx-datepicker-filter/cmx-datepicker-filter.component';
import { CmxFilterSorterComponent } from '../cxm-filter-sorter/cmx-filter-sorter.component';
import { CmxTableComponent } from '../cmx-table/cmx-table.component';
var CmxHeaderCellComponent = /** @class */ (function () {
    function CmxHeaderCellComponent(parent, renderer) {
        this.parent = parent;
        this.renderer = renderer;
        this.cmxHeaderCellClass = true;
        this.hasFiltersClass = false;
        this.activeFiltersClass = false;
        this.showFilters = false;
    }
    /**
     * @return {?}
     */
    CmxHeaderCellComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.checkboxFilters) {
            this.hasFiltersClass = true;
            this.filtersListener = this.checkboxFilters.listenToActiveFilters().subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            function ($event) {
                _this.activeFiltersClass = $event;
            }));
        }
        else if (this.datepickerFilter) {
            this.hasFiltersClass = true;
            this.filtersListener = this.datepickerFilter.listenToActiveFilter().subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            function ($event) {
                _this.activeFiltersClass = $event;
            }));
        }
        else if (this.filterSorter) {
            this.hasFiltersClass = true;
        }
    };
    /**
     * @return {?}
     */
    CmxHeaderCellComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.filtersListener) {
            this.filtersListener.unsubscribe();
        }
    };
    /**
     * @return {?}
     */
    CmxHeaderCellComponent.prototype.toggle = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.checkboxFilters || this.datepickerFilter || this.filterSorter) {
            this.showFilters = !this.showFilters;
            if (this.showFilters) {
                setTimeout((/**
                 * @return {?}
                 */
                function () { return _this.isInsideViewport(); }), 100);
            }
        }
    };
    /**
     * @return {?}
     */
    CmxHeaderCellComponent.prototype.closeFilters = /**
     * @return {?}
     */
    function () {
        this.showFilters = false;
    };
    /**
     * @private
     * @return {?}
     */
    CmxHeaderCellComponent.prototype.isInsideViewport = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var sidePositioner = this.parent.rtl ? 'right' : 'left';
        // clearing
        this.renderer.setStyle(this.filtersContainer.nativeElement, sidePositioner, undefined);
        this.renderer.setStyle(this.filtersContainer.nativeElement, 'top', undefined);
        // calculations
        /** @type {?} */
        var rect = this.filtersContainer.nativeElement.getBoundingClientRect();
        /** @type {?} */
        var screenHeight = window.innerHeight;
        /** @type {?} */
        var screenWidth = window.innerWidth;
        /** @type {?} */
        var adjustment = 20;
        if (this.parent.rtl) {
            if (rect.left < 0) {
                /** @type {?} */
                var pxValue = Math.abs(rect.left);
                this.renderer.setStyle(this.filtersContainer.nativeElement, sidePositioner, (-1 * pxValue) + 'px');
            }
        }
        else {
            if (rect.right > screenWidth) {
                // move to the left
                /** @type {?} */
                var pxValue = Math.abs(rect.right - screenWidth) + adjustment;
                this.renderer.setStyle(this.filtersContainer.nativeElement, sidePositioner, (-1 * pxValue) + 'px');
            }
        }
        if (rect.bottom > screenHeight) {
            // move to the top
            /** @type {?} */
            var pxValue = Math.abs(rect.bottom - screenHeight);
            this.renderer.setStyle(this.filtersContainer.nativeElement, 'top', (-1 * pxValue) + 'px');
        }
    };
    CmxHeaderCellComponent.decorators = [
        { type: Component, args: [{
                    selector: 'cmx-header-cell',
                    template: "<div class=\"cmx-header-cell__text\" (click)=\"toggle()\">\r\n    <div class=\"text-container\">\r\n        <ng-content></ng-content>\r\n        <ng-container *ngIf=\"checkboxFilters || datepickerFilter || filterSorter\">\r\n            <div class=\"cmx-icon__container\">\r\n                <span class=\"cmx-icon-down-single\" aria-hidden=\"true\"></span>\r\n            </div>\r\n        </ng-container>\r\n    </div>\r\n</div>\r\n<ng-container *ngIf=\"showFilters\">\r\n    <div #filtersContainer class=\"cmx-header-cell__filters-container\">\r\n        <ng-content select=\"cmx-checkbox-filters,cmx-datepicker-filter,cmx-filter-sorter\"></ng-content>\r\n    </div>\r\n    <div class=\"cmx-header-cell__mask\" (click)=\"closeFilters()\"></div>\r\n</ng-container>",
                    styles: [".roboto-bold{font-weight:700}.roboto-medium{font-weight:500}.roboto-regular{font-weight:400}.roboto-light{font-weight:300}.roboto-thin{font-weight:100}.h1-role,h1{font-family:Roboto,sans-serif;font-size:3rem;line-height:3rem;font-weight:700;color:#001b3a}.h2-role,.h3-role,h2,h3{font-family:Roboto,sans-serif;font-size:1.625rem;line-height:2rem;font-weight:400;color:#001b3a}.h4-role,h4{font-family:Roboto,sans-serif;font-size:2rem;line-height:2rem;font-weight:500;color:#001b3a}.h5-role,h5{font-family:Roboto,sans-serif;font-size:1.25rem;line-height:1.5rem;font-weight:400;color:#001b3a}.h6-role,h6{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem;font-weight:700;color:#001b3a;text-transform:uppercase}.table-entry{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem}.table-entry-strong{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem;color:#333;font-weight:700}.link,.table-entry,a{text-decoration:none;color:#3fa9f5}a:hover{text-decoration:underline}.input-placeholder{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem;color:#666}.input-text{font-family:Roboto,sans-serif;font-size:.875rem;line-height:1rem;color:#333}.size-15{font-size:.9375rem}.size-24{font-size:1.5rem}.text-left{text-align:left!important}.text-right{text-align:right!important}.text-center{text-align:center!important}.flex-first{order:-1}.flex-last{order:1}.flex-unordered{order:0}.flex-row{flex-direction:row!important}.flex-column{flex-direction:column!important}.flex-row-reverse{flex-direction:row-reverse!important}.flex-column-reverse{flex-direction:column-reverse!important}.flex-wrap{flex-wrap:wrap!important}.flex-nowrap{flex-wrap:nowrap!important}.flex-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-start{justify-content:flex-start!important}.justify-content-end{justify-content:flex-end!important}.justify-content-center{justify-content:center!important}.justify-content-between{justify-content:space-between!important}.justify-content-around{justify-content:space-around!important}.align-items-start{align-items:flex-start!important}.align-items-end{align-items:flex-end!important}.align-items-center{align-items:center!important}.align-items-baseline{align-items:baseline!important}.align-items-stretch{align-items:stretch!important}.align-content-start{align-content:flex-start!important}.align-content-end{align-content:flex-end!important}.align-content-center{align-content:center!important}.align-content-between{align-content:space-between!important}.align-content-around{align-content:space-around!important}.align-content-stretch{align-content:stretch!important}.align-self-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-start{align-self:flex-start!important}.align-self-end{align-self:flex-end!important}.align-self-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-baseline{align-self:baseline!important}.align-self-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}@media (min-width:576px){.text-xs-left{text-align:left!important}.text-xs-right{text-align:right!important}.text-xs-center{text-align:center!important}.flex-xs-first{order:-1}.flex-xs-last{order:1}.flex-xs-unordered{order:0}.flex-xs-row{flex-direction:row!important}.flex-xs-column{flex-direction:column!important}.flex-xs-row-reverse{flex-direction:row-reverse!important}.flex-xs-column-reverse{flex-direction:column-reverse!important}.flex-xs-wrap{flex-wrap:wrap!important}.flex-xs-nowrap{flex-wrap:nowrap!important}.flex-xs-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-xs-start{justify-content:flex-start!important}.justify-content-xs-end{justify-content:flex-end!important}.justify-content-xs-center{justify-content:center!important}.justify-content-xs-between{justify-content:space-between!important}.justify-content-xs-around{justify-content:space-around!important}.align-items-xs-start{align-items:flex-start!important}.align-items-xs-end{align-items:flex-end!important}.align-items-xs-center{align-items:center!important}.align-items-xs-baseline{align-items:baseline!important}.align-items-xs-stretch{align-items:stretch!important}.align-content-xs-start{align-content:flex-start!important}.align-content-xs-end{align-content:flex-end!important}.align-content-xs-center{align-content:center!important}.align-content-xs-between{align-content:space-between!important}.align-content-xs-around{align-content:space-around!important}.align-content-xs-stretch{align-content:stretch!important}.align-self-xs-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-xs-start{align-self:flex-start!important}.align-self-xs-end{align-self:flex-end!important}.align-self-xs-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-xs-baseline{align-self:baseline!important}.align-self-xs-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}@media (min-width:768px){.text-sm-left{text-align:left!important}.text-sm-right{text-align:right!important}.text-sm-center{text-align:center!important}.flex-sm-first{order:-1}.flex-sm-last{order:1}.flex-sm-unordered{order:0}.flex-sm-row{flex-direction:row!important}.flex-sm-column{flex-direction:column!important}.flex-sm-row-reverse{flex-direction:row-reverse!important}.flex-sm-column-reverse{flex-direction:column-reverse!important}.flex-sm-wrap{flex-wrap:wrap!important}.flex-sm-nowrap{flex-wrap:nowrap!important}.flex-sm-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-sm-start{justify-content:flex-start!important}.justify-content-sm-end{justify-content:flex-end!important}.justify-content-sm-center{justify-content:center!important}.justify-content-sm-between{justify-content:space-between!important}.justify-content-sm-around{justify-content:space-around!important}.align-items-sm-start{align-items:flex-start!important}.align-items-sm-end{align-items:flex-end!important}.align-items-sm-center{align-items:center!important}.align-items-sm-baseline{align-items:baseline!important}.align-items-sm-stretch{align-items:stretch!important}.align-content-sm-start{align-content:flex-start!important}.align-content-sm-end{align-content:flex-end!important}.align-content-sm-center{align-content:center!important}.align-content-sm-between{align-content:space-between!important}.align-content-sm-around{align-content:space-around!important}.align-content-sm-stretch{align-content:stretch!important}.align-self-sm-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-sm-start{align-self:flex-start!important}.align-self-sm-end{align-self:flex-end!important}.align-self-sm-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-sm-baseline{align-self:baseline!important}.align-self-sm-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}@media (min-width:1080px){.text-md-left{text-align:left!important}.text-md-right{text-align:right!important}.text-md-center{text-align:center!important}.flex-md-first{order:-1}.flex-md-last{order:1}.flex-md-unordered{order:0}.flex-md-row{flex-direction:row!important}.flex-md-column{flex-direction:column!important}.flex-md-row-reverse{flex-direction:row-reverse!important}.flex-md-column-reverse{flex-direction:column-reverse!important}.flex-md-wrap{flex-wrap:wrap!important}.flex-md-nowrap{flex-wrap:nowrap!important}.flex-md-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-md-start{justify-content:flex-start!important}.justify-content-md-end{justify-content:flex-end!important}.justify-content-md-center{justify-content:center!important}.justify-content-md-between{justify-content:space-between!important}.justify-content-md-around{justify-content:space-around!important}.align-items-md-start{align-items:flex-start!important}.align-items-md-end{align-items:flex-end!important}.align-items-md-center{align-items:center!important}.align-items-md-baseline{align-items:baseline!important}.align-items-md-stretch{align-items:stretch!important}.align-content-md-start{align-content:flex-start!important}.align-content-md-end{align-content:flex-end!important}.align-content-md-center{align-content:center!important}.align-content-md-between{align-content:space-between!important}.align-content-md-around{align-content:space-around!important}.align-content-md-stretch{align-content:stretch!important}.align-self-md-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-md-start{align-self:flex-start!important}.align-self-md-end{align-self:flex-end!important}.align-self-md-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-md-baseline{align-self:baseline!important}.align-self-md-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}@media (min-width:1320px){.text-lg-left{text-align:left!important}.text-lg-right{text-align:right!important}.text-lg-center{text-align:center!important}.flex-lg-first{order:-1}.flex-lg-last{order:1}.flex-lg-unordered{order:0}.flex-lg-row{flex-direction:row!important}.flex-lg-column{flex-direction:column!important}.flex-lg-row-reverse{flex-direction:row-reverse!important}.flex-lg-column-reverse{flex-direction:column-reverse!important}.flex-lg-wrap{flex-wrap:wrap!important}.flex-lg-nowrap{flex-wrap:nowrap!important}.flex-lg-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-lg-start{justify-content:flex-start!important}.justify-content-lg-end{justify-content:flex-end!important}.justify-content-lg-center{justify-content:center!important}.justify-content-lg-between{justify-content:space-between!important}.justify-content-lg-around{justify-content:space-around!important}.align-items-lg-start{align-items:flex-start!important}.align-items-lg-end{align-items:flex-end!important}.align-items-lg-center{align-items:center!important}.align-items-lg-baseline{align-items:baseline!important}.align-items-lg-stretch{align-items:stretch!important}.align-content-lg-start{align-content:flex-start!important}.align-content-lg-end{align-content:flex-end!important}.align-content-lg-center{align-content:center!important}.align-content-lg-between{align-content:space-between!important}.align-content-lg-around{align-content:space-around!important}.align-content-lg-stretch{align-content:stretch!important}.align-self-lg-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-lg-start{align-self:flex-start!important}.align-self-lg-end{align-self:flex-end!important}.align-self-lg-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-lg-baseline{align-self:baseline!important}.align-self-lg-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}@media (min-width:1560px){.text-xlg-left{text-align:left!important}.text-xlg-right{text-align:right!important}.text-xlg-center{text-align:center!important}.flex-xlg-first{order:-1}.flex-xlg-last{order:1}.flex-xlg-unordered{order:0}.flex-xlg-row{flex-direction:row!important}.flex-xlg-column{flex-direction:column!important}.flex-xlg-row-reverse{flex-direction:row-reverse!important}.flex-xlg-column-reverse{flex-direction:column-reverse!important}.flex-xlg-wrap{flex-wrap:wrap!important}.flex-xlg-nowrap{flex-wrap:nowrap!important}.flex-xlg-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-xlg-start{justify-content:flex-start!important}.justify-content-xlg-end{justify-content:flex-end!important}.justify-content-xlg-center{justify-content:center!important}.justify-content-xlg-between{justify-content:space-between!important}.justify-content-xlg-around{justify-content:space-around!important}.align-items-xlg-start{align-items:flex-start!important}.align-items-xlg-end{align-items:flex-end!important}.align-items-xlg-center{align-items:center!important}.align-items-xlg-baseline{align-items:baseline!important}.align-items-xlg-stretch{align-items:stretch!important}.align-content-xlg-start{align-content:flex-start!important}.align-content-xlg-end{align-content:flex-end!important}.align-content-xlg-center{align-content:center!important}.align-content-xlg-between{align-content:space-between!important}.align-content-xlg-around{align-content:space-around!important}.align-content-xlg-stretch{align-content:stretch!important}.align-self-xlg-auto{-ms-grid-row-align:auto!important;align-self:auto!important}.align-self-xlg-start{align-self:flex-start!important}.align-self-xlg-end{align-self:flex-end!important}.align-self-xlg-center{-ms-grid-row-align:center!important;align-self:center!important}.align-self-xlg-baseline{align-self:baseline!important}.align-self-xlg-stretch{-ms-grid-row-align:stretch!important;align-self:stretch!important}}:host.cmx-header-cell{font-family:Roboto,sans-serif;padding-left:12px;padding-right:12px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;position:relative}:host.cmx-header-cell.--has-filters{cursor:pointer}:host.cmx-header-cell.--has-filters .cmx-header-cell__text:hover{color:#3fa9f5}:host.cmx-header-cell.--has-filters .text-container{padding-right:16px}:host.cmx-header-cell.--active-filters .cmx-header-cell__text{color:#3fa9f5}:host.cmx-header-cell.--number .cmx-header-cell__text{text-align:right}:host.cmx-header-cell.--number .text-container{float:right}html[dir=rtl] :host.cmx-header-cell.--has-filters .cmx-icon__container{left:0;right:unset}html[dir=rtl] :host.cmx-header-cell.--has-filters .text-container{padding-right:0;padding-left:16px}html[dir=rtl] :host.cmx-header-cell.--number .cmx-header-cell__text{text-align:left}html[dir=rtl] :host.cmx-header-cell.--number .text-container{float:left}svg{width:10px;height:10px;margin-left:4px;fill:#3fa9f5}.cmx-header-cell__text{font-weight:700;color:#001b3a;font-size:.875rem;width:100%}.cmx-header-cell__filters-container{z-index:10;position:absolute;top:100%;width:auto;height:auto;background-color:#fff;box-shadow:0 8px 13px rgba(0,0,0,.3);-webkit-box-shadow:0 8px 13px rgba(0,0,0,.3);-moz-box-shadow:0 8px 13px rgba(0,0,0,.3)}.cmx-header-cell__mask{z-index:9;opacity:0;background:0 0;position:fixed;width:100vw;height:100vh;top:0;left:0;display:block;cursor:default}.text-container{position:relative;overflow:hidden;text-overflow:ellipsis;width:auto;display:inline-block}.cmx-icon__container{position:absolute;top:0;right:0}"]
                }] }
    ];
    /** @nocollapse */
    CmxHeaderCellComponent.ctorParameters = function () { return [
        { type: CmxTableComponent, decorators: [{ type: Host }] },
        { type: Renderer2 }
    ]; };
    CmxHeaderCellComponent.propDecorators = {
        cmxHeaderCellClass: [{ type: HostBinding, args: ['class.cmx-header-cell',] }],
        hasFiltersClass: [{ type: HostBinding, args: ['class.--has-filters',] }],
        activeFiltersClass: [{ type: HostBinding, args: ['class.--active-filters',] }],
        checkboxFilters: [{ type: ContentChild, args: [CmxCheckboxFiltersComponent,] }],
        datepickerFilter: [{ type: ContentChild, args: [CmxDatepickerFilterComponent,] }],
        filterSorter: [{ type: ContentChild, args: [CmxFilterSorterComponent,] }],
        filtersContainer: [{ type: ViewChild, args: ['filtersContainer',] }]
    };
    return CmxHeaderCellComponent;
}());
export { CmxHeaderCellComponent };
if (false) {
    /** @type {?} */
    CmxHeaderCellComponent.prototype.cmxHeaderCellClass;
    /** @type {?} */
    CmxHeaderCellComponent.prototype.hasFiltersClass;
    /** @type {?} */
    CmxHeaderCellComponent.prototype.activeFiltersClass;
    /** @type {?} */
    CmxHeaderCellComponent.prototype.checkboxFilters;
    /** @type {?} */
    CmxHeaderCellComponent.prototype.datepickerFilter;
    /** @type {?} */
    CmxHeaderCellComponent.prototype.filterSorter;
    /** @type {?} */
    CmxHeaderCellComponent.prototype.filtersContainer;
    /** @type {?} */
    CmxHeaderCellComponent.prototype.showFilters;
    /**
     * @type {?}
     * @private
     */
    CmxHeaderCellComponent.prototype.filtersListener;
    /**
     * @type {?}
     * @private
     */
    CmxHeaderCellComponent.prototype.parent;
    /**
     * @type {?}
     * @private
     */
    CmxHeaderCellComponent.prototype.renderer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY214LWhlYWRlci1jZWxsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BjZW1leC9jbXgtdGFibGUtdjcvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9jbXgtaGVhZGVyLWNlbGwvY214LWhlYWRlci1jZWxsLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUNILFNBQVMsRUFHVCxXQUFXLEVBQ1gsWUFBWSxFQUNaLElBQUksRUFDSixTQUFTLEVBQ1QsU0FBUyxFQUNULFVBQVUsRUFDYixNQUFNLGVBQWUsQ0FBQztBQUl2QixPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSx3REFBd0QsQ0FBQztBQUNyRyxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSwwREFBMEQsQ0FBQztBQUN4RyxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxrREFBa0QsQ0FBQztBQUM1RixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUVyRTtJQXNCSSxnQ0FDb0IsTUFBeUIsRUFDakMsUUFBbUI7UUFEWCxXQUFNLEdBQU4sTUFBTSxDQUFtQjtRQUNqQyxhQUFRLEdBQVIsUUFBUSxDQUFXO1FBbEJnQix1QkFBa0IsR0FBRyxJQUFJLENBQUM7UUFDNUIsb0JBQWUsR0FBRyxLQUFLLENBQUM7UUFDckIsdUJBQWtCLEdBQUcsS0FBSyxDQUFDO1FBV3BFLGdCQUFXLEdBQUcsS0FBSyxDQUFDO0lBTXZCLENBQUM7Ozs7SUFFRSxtREFBa0I7OztJQUF6QjtRQUFBLGlCQWtCQztRQWpCRyxJQUFLLElBQUksQ0FBQyxlQUFlLEVBQUc7WUFDeEIsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUM7WUFDNUIsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLHFCQUFxQixFQUFFLENBQUMsU0FBUzs7OztZQUN6RSxVQUFFLE1BQU07Z0JBQ0osS0FBSSxDQUFDLGtCQUFrQixHQUFH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Q0o7UUFDRCxJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsWUFBWSxFQUFFOzs7Z0JBRXRCLE9BQU8sR0FBVyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsWUFBWSxDQUFDO1lBQzVELElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUNsQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FDcEUsQ0FBQztTQUNMO0lBQ0wsQ0FBQzs7Z0JBbkdKLFNBQVMsU0FBQztvQkFDUCxRQUFRLEVBQUUsaUJBQWlCO29CQUMzQiwwd0JBQStDOztpQkFFbEQ7Ozs7Z0JBTlEsaUJBQWlCLHVCQXlCakIsSUFBSTtnQkFuQ1QsU0FBUzs7O3FDQWtCUixXQUFXLFNBQUUsdUJBQXVCO2tDQUNwQyxXQUFXLFNBQUUscUJBQXFCO3FDQUNsQyxXQUFXLFNBQUUsd0JBQXdCO2tDQUVyQyxZQUFZLFNBQUUsMkJBQTJCO21DQUV6QyxZQUFZLFNBQUUsNEJBQTRCOytCQUUxQyxZQUFZLFNBQUUsd0JBQXdCO21DQUV0QyxTQUFTLFNBQUMsa0JBQWtCOztJQW9GakMsNkJBQUM7Q0FBQSxBQXBHRCxJQW9HQztTQS9GWSxzQkFBc0I7OztJQUMvQixvREFBeUU7O0lBQ3pFLGlEQUFxRTs7SUFDckUsb0RBQTJFOztJQUUzRSxpREFDb0Q7O0lBQ3BELGtEQUNzRDs7SUFDdEQsOENBQzhDOztJQUM5QyxrREFDb0M7O0lBRXBDLDZDQUEyQjs7Ozs7SUFDM0IsaURBQXNDOzs7OztJQUdsQyx3Q0FBeUM7Ozs7O0lBQ3pDLDBDQUEyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsXHJcbiAgICBBZnRlckNvbnRlbnRJbml0LFxyXG4gICAgT25EZXN0cm95LFxyXG4gICAgSG9zdEJpbmRpbmcsXHJcbiAgICBDb250ZW50Q2hpbGQsXHJcbiAgICBIb3N0LFxyXG4gICAgUmVuZGVyZXIyLFxyXG4gICAgVmlld0NoaWxkLFxyXG4gICAgRWxlbWVudFJlZlxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcblxyXG5pbXBvcnQgeyBDbXhDaGVja2JveEZpbHRlcnNDb21wb25lbnQgfSBmcm9tICcuLi9jbXgtY2hlY2tib3gtZmlsdGVycy9jbXgtY2hlY2tib3gtZmlsdGVycy5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBDbXhEYXRlcGlja2VyRmlsdGVyQ29tcG9uZW50IH0gZnJvbSAnLi4vY214LWRhdGVwaWNrZXItZmlsdGVyL2NteC1kYXRlcGlja2VyLWZpbHRlci5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBDbXhGaWx0ZXJTb3J0ZXJDb21wb25lbnQgfSBmcm9tICcuLi9jeG0tZmlsdGVyLXNvcnRlci9jbXgtZmlsdGVyLXNvcnRlci5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBDbXhUYWJsZUNvbXBvbmVudCB9IGZyb20gJy4uL2NteC10YWJsZS9jbXgtdGFibGUuY29tcG9uZW50JztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdjbXgtaGVhZGVyLWNlbGwnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2NteC1oZWFkZXItY2VsbC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsgJy4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vc2Nzcy9jbXgtdGFibGUvdjEvY214LWhlYWRlci1jZWxsLmNvbXBvbmVudC5zY3NzJyBdLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgQ214SGVhZGVyQ2VsbENvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyQ29udGVudEluaXQsIE9uRGVzdHJveSB7XHJcbiAgICBASG9zdEJpbmRpbmcoICdjbGFzcy5jbXgtaGVhZGVyLWNlbGwnICkgcHVibGljIGNteEhlYWRlckNlbGxDbGFzcyA9IHRydWU7XHJcbiAgICBASG9zdEJpbmRpbmcoICdjbGFzcy4tLWhhcy1maWx0ZXJzJyApIHB1YmxpYyBoYXNGaWx0ZXJzQ2xhc3MgPSBmYWxzZTtcclxuICAgIEBIb3N0QmluZGluZyggJ2NsYXNzLi0tYWN0aXZlLWZpbHRlcnMnICkgcHVibGljIGFjdGl2ZUZpbHRlcnNDbGFzcyA9IGZhbHNlO1xyXG4gICAgLy8gQEhvc3RCaW5kaW5nKCdhdHRyLmRpcicpIHByaXZhdGUgZGlyQXR0cjogc3RyaW5nID0gJ2F1dG8nO1xyXG4gICAgQENvbnRlbnRDaGlsZCggQ214Q2hlY2tib3hGaWx0ZXJzQ29tcG9uZW50IClcclxuICAgIHB1YmxpYyBjaGVja2JveEZpbHRlcnM6IENteENoZWNrYm94RmlsdGVyc0NvbXBvbmVudDtcclxuICAgIEBDb250ZW50Q2hpbGQoIENteERhdGVwaWNrZXJGaWx0ZXJDb21wb25lbnQgKVxyXG4gICAgcHVibGljIGRhdGVwaWNrZXJGaWx0ZXI6IENteERhdGVwaWNrZXJGaWx0ZXJDb21wb25lbnQ7XHJcbiAgICBAQ29udGVudENoaWxkKCBDbXhGaWx0ZXJTb3J0ZXJDb21wb25lbnQgKVxyXG4gICAgcHVibGljIGZpbHRlclNvcnRlcjogQ214RmlsdGVyU29ydGVyQ29tcG9uZW50O1xyXG4gICAgQFZpZXdDaGlsZCgnZmlsdGVyc0NvbnRhaW5lcicpXHJcbiAgICBwdWJsaWMgZmlsdGVyc0NvbnRhaW5lcjogRWxlbWVudFJlZjtcclxuXHJcbiAgICBwdWJsaWMgc2hvd0ZpbHRlcnMgPSBmYWxzZTtcclxuICAgIHByaXZhdGUgZmlsdGVyc0xpc3RlbmVyOiBTdWJzY3JpcHRpb247XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgQEhvc3QoKSBwcml2YXRlIHBhcmVudDogQ214VGFibGVDb21wb25lbnQsXHJcbiAgICAgICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLFxyXG4gICAgKSB7IH1cclxuXHJcbiAgICBwdWJsaWMgbmdBZnRlckNvbnRlbnRJbml0KCk6IHZvaWQge1xyXG4gICAgICAgIGlmICggdGhpcy5jaGVja2JveEZpbHRlcnMgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFzRmlsdGVyc0NsYXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJzTGlzdGVuZXIgPSB0aGlzLmNoZWNrYm94RmlsdGVycy5saXN0ZW5Ub0FjdGl2ZUZpbHRlcnMoKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgICAoICRldmVudCApID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUZpbHRlcnNDbGFzcyA9ICRldmVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLmRhdGVwaWNrZXJGaWx0ZXIgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFzRmlsdGVyc0NsYXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJzTGlzdGVuZXIgPSB0aGlzLmRhdGVwaWNrZXJGaWx0ZXIubGlzdGVuVG9BY3RpdmVGaWx0ZXIoKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgICAoICRldmVudCApID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUZpbHRlcnNDbGFzcyA9ICRldmVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLmZpbHRlclNvcnRlciApIHtcclxuICAgICAgICAgICAgdGhpcy5oYXNGaWx0ZXJzQ2xhc3MgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCB0aGlzLmZpbHRlcnNMaXN0ZW5lciApIHtcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJzTGlzdGVuZXIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHRvZ2dsZSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIHRoaXMuY2hlY2tib3hGaWx0ZXJzIHx8IHRoaXMuZGF0ZXBpY2tlckZpbHRlciB8fCB0aGlzLmZpbHRlclNvcnRlciApIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93RmlsdGVycyA9ICF0aGlzLnNob3dGaWx0ZXJzO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zaG93RmlsdGVycykge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmlzSW5zaWRlVmlld3BvcnQoKSwgMTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xvc2VGaWx0ZXJzKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc2hvd0ZpbHRlcnMgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGlzSW5zaWRlVmlld3BvcnQoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3Qgc2lkZVBvc2l0aW9uZXI6IHN0cmluZyA9IHRoaXMucGFyZW50LnJ0bCA/ICdyaWdodCcgOiAnbGVmdCc7XHJcbiAgICAgICAgLy8gY2xlYXJpbmdcclxuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZmlsdGVyc0NvbnRhaW5lci5uYXRpdmVFbGVtZW50LCBzaWRlUG9zaXRpb25lciwgdW5kZWZpbmVkKTtcclxuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZmlsdGVyc0NvbnRhaW5lci5uYXRpdmVFbGVtZW50LCAndG9wJywgdW5kZWZpbmVkKTtcclxuICAgICAgICAvLyBjYWxjdWxhdGlvbnNcclxuICAgICAgICBjb25zdCByZWN0OiBDbGllbnRSZWN0ID0gdGhpcy5maWx0ZXJzQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgY29uc3Qgc2NyZWVuSGVpZ2h0OiBudW1iZXIgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcbiAgICAgICAgY29uc3Qgc2NyZWVuV2lkdGg6IG51bWJlciA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgIGNvbnN0IGFkanVzdG1lbnQgPSAyMDtcclxuICAgICAgICBpZiAodGhpcy5wYXJlbnQucnRsKSB7XHJcbiAgICAgICAgICAgIGlmIChyZWN0LmxlZnQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBweFZhbHVlOiBudW1iZXIgPSBNYXRoLmFicyhyZWN0LmxlZnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbHRlcnNDb250YWluZXIubmF0aXZlRWxlbWVudCwgc2lkZVBvc2l0aW9uZXIsICgtMSAqIHB4VmFsdWUpICsgJ3B4JyxcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAocmVjdC5yaWdodCA+IHNjcmVlbldpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBtb3ZlIHRvIHRoZSBsZWZ0XHJcbiAgICAgICAgICAgICAgICBjb25zdCBweFZhbHVlOiBudW1iZXIgPSBNYXRoLmFicyhyZWN0LnJpZ2h0IC0gc2NyZWVuV2lkdGgpICsgYWRqdXN0bWVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJzQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQsIHNpZGVQb3NpdGlvbmVyLCAoLTEgKiBweFZhbHVlKSArICdweCcsXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZWN0LmJvdHRvbSA+IHNjcmVlbkhlaWdodCkge1xyXG4gICAgICAgICAgICAvLyBtb3ZlIHRvIHRoZSB0b3BcclxuICAgICAgICAgICAgY29uc3QgcHhWYWx1ZTogbnVtYmVyID0gTWF0aC5hYnMocmVjdC5ib3R0b20gLSBzY3JlZW5IZWlnaHQpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJzQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQsICd0b3AnLCAoLTEgKiBweFZhbHVlKSArICdweCcsXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==