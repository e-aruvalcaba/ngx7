describe('Single date selection', function() {
  it('starts the application', function() {
    cy.clearCookies();
    cy.clearLocalStorage();
    cy.window().then(win => {
      win.sessionStorage.clear();
    });
    cy.visit('http://localhost:8000//');
  });

  it('Set 14/05/2019', function() {
    cy.get('#single').clear();
    cy.get('#single').type('14/05/2019');
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__body > .cmx-datepicker__days-grid > tbody > :nth-child(3) > :nth-child(2) > button',
    ).contains('14');
  });

  it('Set next day', function() {
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__body > .cmx-datepicker__days-grid > tbody > :nth-child(3) > :nth-child(3) > button',
    ).click({ force: true });
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__body > .cmx-datepicker__days-grid > tbody > :nth-child(3) > :nth-child(3) > button',
    ).contains('15');
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__footer > .cmx-datepicker__cta > .cmx-apply-button',
    ).contains('Aplicar');
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__footer > .cmx-datepicker__cta > .cmx-apply-button',
    ).click({ force: true });
    cy.get('#singleValue').contains('15/05/2019');
  });

  it('Set next year', function() {
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__header > .cmx-datepicker__current-period > :nth-child(2)',
    ).contains('2019');
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__header > .cmx-datepicker__current-period > :nth-child(2)',
    ).click({ force: true });
    cy.get(
      ':nth-child(3) > :nth-child(3) > .cmx-datepicker__year',
    ).click({ force: true });
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__header > .cmx-datepicker__current-period > :nth-child(2)',
    ).contains('2020');
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__body > .cmx-datepicker__days-grid > tbody > :nth-child(3) > :nth-child(5) > .cmx-datepicker__day',
    ).contains('15');
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__body > .cmx-datepicker__days-grid > tbody > :nth-child(3) > :nth-child(5) > .cmx-datepicker__day',
    ).click({ force: true });
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__footer > .cmx-datepicker__cta > .cmx-apply-button',
    ).contains('Aplicar');
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__footer > .cmx-datepicker__cta > .cmx-apply-button',
    ).click({ force: true });
    cy.get('#singleValue').contains('15/05/2020');
  });

  it('Move to previous month and go back', function() {
    cy.get('#datepickerSingle > .cmx-datepicker > .cmx-datepicker__header > .cmx-datepicker__current-period > :nth-child(1)').contains('May');
    cy.get('#datepickerSingle > .cmx-datepicker > .cmx-datepicker__header > [srtext="Previous Month"] > .cmx-icon-straight-arrow-left').click({ force: true });
    cy.get('#datepickerSingle > .cmx-datepicker > .cmx-datepicker__header > .cmx-datepicker__current-period > :nth-child(1)').contains('April');
    cy.get('#datepickerSingle > .cmx-datepicker > .cmx-datepicker__header > [srtext="Next Month"] > .cmx-icon-straight-arrow-right').click({ force: true });
    cy.get('#datepickerSingle > .cmx-datepicker > .cmx-datepicker__header > .cmx-datepicker__current-period > :nth-child(1)').contains('May');
  });
  
  it('Should have saturdays, thursdays and tuesdays disabled', function() {
    cy.get(
      '#datepickerRtlTuesday > div > div.cmx-datepicker__body > table > tbody > tr:nth-child(2) > td:nth-child(2) > button',
    ).should('have.class', 'disabled');
    cy.get(
      '#datepickerRtlTuesday > div > div.cmx-datepicker__body > table > tbody > tr:nth-child(1) > td:nth-child(6) > button',
    ).should('have.class', 'disabled');
    cy.get(
      '#datepickerRtlTuesday > div > div.cmx-datepicker__body > table > tbody > tr:nth-child(4) > td:nth-child(4) > button',
    ).should('have.class', 'disabled');
  });

  it('Should have May 6 and 26 2020 disabled', function() {
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__body > .cmx-datepicker__days-grid > tbody > :nth-child(2) > :nth-child(3) > .cmx-datepicker__day',
    ).should('have.class', 'disabled').contains(6);
    cy.get(
      '#datepickerSingle > .cmx-datepicker > .cmx-datepicker__body > .cmx-datepicker__days-grid > tbody > :nth-child(5) > :nth-child(2) > .cmx-datepicker__day',
    ).should('have.class', 'disabled').contains(26);
  });
});
