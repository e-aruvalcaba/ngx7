/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, } from '@angular/core';
import { CmxDialogComponent } from './../components/cmx-dialog/cmx-dialog.component';
import { CmxDialogConfirmationComponent } from '../components/cmx-dialog-confirmation/cmx-dialog-confirmation.component';
import { ConfirmationType } from '../components/cmx-dialog-confirmation/cmx-dialog-confirmation.component';
import * as i0 from "@angular/core";
var CmxDialogGeneratorService = /** @class */ (function () {
    function CmxDialogGeneratorService() {
        this.dialogDelay = 100;
        this.defaultSuccessMessage = 'This is a dynamically generated confirmation success dialog';
        this.defaultWarningMessage = 'This is a dynamically generated confirmation warning dialog';
        this.defaultErrorMessage = 'This is a dynamically generated confirmation error dialog';
        this.defaultErrorMessageDetail = 'This is a message detail';
    }
    /**
     * @param {?} viewContainerRef
     * @param {?} componentFactoryResolver
     * @param {?} options
     * @return {?}
     */
    CmxDialogGeneratorService.prototype.createConfirmationDialog = /**
     * @param {?} viewContainerRef
     * @param {?} componentFactoryResolver
     * @param {?} options
     * @return {?}
     */
    function (viewContainerRef, componentFactoryResolver, options) {
        // tslint:disable-next-line:max-line-length
        /** @type {?} */
        var componentFactory = componentFactoryResolver.resolveComponentFactory(CmxDialogConfirmationComponent);
        /** @type {?} */
        var componentRef = viewContainerRef.createComponent(componentFactory);
        // tslint:disable-next-line:typedef
        /** @type {?} */
        var component = ((/** @type {?} */ (componentRef.instance)));
        this.setDialogSubscriptions(options, component.dialog);
        this.openConfirmationDialog(options, component);
        return component;
    };
    /* experimental */
    /* experimental */
    /**
     * @param {?} viewContainerRef
     * @param {?} componentFactoryResolver
     * @param {?} componentTemplate
     * @param {?} options
     * @return {?}
     */
    CmxDialogGeneratorService.prototype.createCustomDialog = /* experimental */
    /**
     * @param {?} viewContainerRef
     * @param {?} componentFactoryResolver
     * @param {?} componentTemplate
     * @param {?} options
     * @return {?}
     */
    function (viewContainerRef, componentFactoryResolver, componentTemplate, options) {
        /** @type {?} */
        var componentFactory = componentFactoryResolver.resolveComponentFactory(CmxDialogComponent);
        /** @type {?} */
        var componentRef = viewContainerRef.createComponent(componentFactory);
        // tslint:disable-next-line:typedef
        /** @type {?} */
        var component = ((/** @type {?} */ (componentRef.instance)));
        if (!(componentTemplate instanceof CmxDialogComponent)) {
            return component;
        }
        this.setDialogComponent(component, componentTemplate);
        this.setDialogComponentTimer(options, component);
        return component;
    };
    /**
     * @private
     * @param {?} options
     * @param {?} component
     * @return {?}
     */
    CmxDialogGeneratorService.prototype.setDialogSubscriptions = /**
     * @private
     * @param {?} options
     * @param {?} component
     * @return {?}
     */
    function (options, component) {
        if (options.afterClosed) {
            component.afterClosed().subscribe(options.afterClosed());
        }
        if (options.afterOpened) {
            component.afterOpened().subscribe(options.afterOpened());
        }
    };
    /**
     * @private
     * @param {?} options
     * @param {?} component
     * @return {?}
     */
    CmxDialogGeneratorService.prototype.openConfirmationDialog = /**
     * @private
     * @param {?} options
     * @param {?} component
     * @return {?}
     */
    function (options, component) {
        if (options.type === ConfirmationType.Success) {
            component.openAsSuccess(options.message ? options.message : this.defaultSuccessMessage);
        }
        else if (options.type === ConfirmationType.Warning) {
            component.openAsWarning(options.message ? options.message : this.defaultWarningMessage);
        }
        else if (options.type === ConfirmationType.Error) {
            component.openAsError(options.message ? options.message : this.defaultErrorMessage, options.messageDetail ? options.messageDetail : this.defaultErrorMessageDetail);
        }
    };
    /**
     * @private
     * @param {?} component
     * @param {?} componentTemplate
     * @return {?}
     */
    CmxDialogGeneratorService.prototype.setDialogComponent = /**
     * @private
     * @param {?} component
     * @param {?} componentTemplate
     * @return {?}
     */
    function (component, componentTemplate) {
        component.enableHeader = componentTemplate.enableHeader;
        component.enableFooter = componentTemplate.enableFooter;
        component.enableClose = componentTemplate.enableClose;
        component.backgroundColor = componentTemplate.backgroundColor;
        component.rtl = componentTemplate.rtl;
        component.dirAttr = componentTemplate.dirAttr;
        console.log(component);
        if (component.enableHeader) {
            setTimeout((/**
             * @return {?}
             */
            function () {
                component.dialogHeader.nativeElement.innerHTML = componentTemplate.dialogHeader.nativeElement.innerHTML;
            }), this.dialogDelay);
        }
        if (component.enableFooter) {
            setTimeout((/**
             * @return {?}
             */
            function () {
                component.dialogFooter.nativeElement.innerHTML = componentTemplate.dialogFooter.nativeElement.innerHTML;
            }), this.dialogDelay);
        }
        setTimeout((/**
         * @return {?}
         */
        function () {
            component.dialogBody.nativeElement.innerHTML = componentTemplate.dialogBody.nativeElement.innerHTML;
        }), this.dialogDelay);
    };
    /**
     * @private
     * @param {?} options
     * @param {?} component
     * @return {?}
     */
    CmxDialogGeneratorService.prototype.setDialogComponentTimer = /**
     * @private
     * @param {?} options
     * @param {?} component
     * @return {?}
     */
    function (options, component) {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.setDialogSubscriptions(options, component);
            component.open();
        }), this.dialogDelay);
    };
    CmxDialogGeneratorService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root',
                },] }
    ];
    /** @nocollapse */ CmxDialogGeneratorService.ngInjectableDef = i0.defineInjectable({ factory: function CmxDialogGeneratorService_Factory() { return new CmxDialogGeneratorService(); }, token: CmxDialogGeneratorService, providedIn: "root" });
    return CmxDialogGeneratorService;
}());
export { CmxDialogGeneratorService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    CmxDialogGeneratorService.prototype.dialogDelay;
    /**
     * @type {?}
     * @private
     */
    CmxDialogGeneratorService.prototype.defaultSuccessMessage;
    /**
     * @type {?}
     * @private
     */
    CmxDialogGeneratorService.prototype.defaultWarningMessage;
    /**
     * @type {?}
     * @private
     */
    CmxDialogGeneratorService.prototype.defaultErrorMessage;
    /**
     * @type {?}
     * @private
     */
    CmxDialogGeneratorService.prototype.defaultErrorMessageDetail;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY214LWRpYWxvZy1nZW5lcmF0b3Iuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BjZW1leC9jbXgtZGlhbG9nLXY3LyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL2NteC1kaWFsb2ctZ2VuZXJhdG9yLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCxVQUFVLEdBS2IsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLGtCQUFrQixFQUFrQixNQUFNLGlEQUFpRCxDQUFDO0FBQ3JHLE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLHlFQUF5RSxDQUFDO0FBQ3pILE9BQU8sRUFBRSxnQkFBZ0IsRUFBOEIsTUFBTSx5RUFBeUUsQ0FBQzs7QUFFdkk7SUFBQTtRQUtZLGdCQUFXLEdBQUcsR0FBRyxDQUFDO1FBQ2xCLDBCQUFxQixHQUFHLDZEQUE2RCxDQUFDO1FBQ3RGLDBCQUFxQixHQUFHLDZEQUE2RCxDQUFDO1FBQ3RGLHdCQUFtQixHQUFHLDJEQUEyRCxDQUFDO1FBQ2xGLDhCQUF5QixHQUFHLDBCQUEwQixDQUFDO0tBMkZsRTs7Ozs7OztJQXpGVSw0REFBd0I7Ozs7OztJQUEvQixVQUNJLGdCQUFrQyxFQUNsQyx3QkFBa0QsRUFDbEQsT0FBbUM7OztZQUU3QixnQkFBZ0IsR0FBcUQsd0JBQXdCLENBQUMsdUJBQXVCLENBQUMsOEJBQThCLENBQUM7O1lBQ3JKLFlBQVksR0FBaUQsZ0JBQWdCLENBQUMsZUFBZSxDQUFDLGdCQUFnQixDQUFDOzs7WUFHL0csU0FBUyxHQUFHLENBQUMsbUJBQUEsWUFBWSxDQUFDLFFBQVEsRUFBa0MsQ0FBQztRQUMzRSxJQUFJLENBQUMsc0JBQXNCLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUN2RCxJQUFJLENBQUMsc0JBQXNCLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQ2hELE9BQU8sU0FBUyxDQUFDO0lBQ3JCLENB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c291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgICBJbmplY3RhYmxlLFxuICAgIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcbiAgICBWaWV3Q29udGFpbmVyUmVmLFxuICAgIENvbXBvbmVudEZhY3RvcnksXG4gICAgQ29tcG9uZW50UmVmLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgQ214RGlhbG9nQ29tcG9uZW50LCBJRGlhbG9nT3B0aW9ucyB9IGZyb20gJy4vLi4vY29tcG9uZW50cy9jbXgtZGlhbG9nL2NteC1kaWFsb2cuY29tcG9uZW50JztcbmltcG9ydCB7IENteERpYWxvZ0NvbmZpcm1hdGlvbkNvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudHMvY214LWRpYWxvZy1jb25maXJtYXRpb24vY214LWRpYWxvZy1jb25maXJtYXRpb24uY29tcG9uZW50JztcbmltcG9ydCB7IENvbmZpcm1hdGlvblR5cGUsIElDb25maXJtYXRpb25EaWFsb2dPcHRpb25zIH0gZnJvbSAnLi4vY29tcG9uZW50cy9jbXgtZGlhbG9nLWNvbmZpcm1hdGlvbi9jbXgtZGlhbG9nLWNvbmZpcm1hdGlvbi5jb21wb25lbnQnO1xuXG5ASW5qZWN0YWJsZSh7XG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxufSlcbmV4cG9ydCBjbGFzcyBDbXhEaWFsb2dHZW5lcmF0b3JTZXJ2aWNlIHtcblxuICAgIHByaXZhdGUgZGlhbG9nRGVsYXkgPSAxMDA7XG4gICAgcHJpdmF0ZSBkZWZhdWx0U3VjY2Vzc01lc3NhZ2UgPSAnVGhpcyBpcyBhIGR5bmFtaWNhbGx5IGdlbmVyYXRlZCBjb25maXJtYXRpb24gc3VjY2VzcyBkaWFsb2cnO1xuICAgIHByaXZhdGUgZGVmYXVsdFdhcm5pbmdNZXNzYWdlID0gJ1RoaXMgaXMgYSBkeW5hbWljYWxseSBnZW5lcmF0ZWQgY29uZmlybWF0aW9uIHdhcm5pbmcgZGlhbG9nJztcbiAgICBwcml2YXRlIGRlZmF1bHRFcnJvck1lc3NhZ2UgPSAnVGhpcyBpcyBhIGR5bmFtaWNhbGx5IGdlbmVyYXRlZCBjb25maXJtYXRpb24gZXJyb3IgZGlhbG9nJztcbiAgICBwcml2YXRlIGRlZmF1bHRFcnJvck1lc3NhZ2VEZXRhaWwgPSAnVGhpcyBpcyBhIG1lc3NhZ2UgZGV0YWlsJztcblxuICAgIHB1YmxpYyBjcmVhdGVDb25maXJtYXRpb25EaWFsb2coXG4gICAgICAgIHZpZXdDb250YWluZXJSZWY6IFZpZXdDb250YWluZXJSZWYsXG4gICAgICAgIGNvbXBvbmVudEZhY3RvcnlSZXNvbHZlcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxuICAgICAgICBvcHRpb25zOiBJQ29uZmlybWF0aW9uRGlhbG9nT3B0aW9ucyk6IENteERpYWxvZ0NvbmZpcm1hdGlvbkNvbXBvbmVudCB7XG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcbiAgICAgICAgY29uc3QgY29tcG9uZW50RmFjdG9yeTogQ29tcG9uZW50RmFjdG9yeTxDbXhEaWFsb2dDb25maXJtYXRpb25Db21wb25lbnQ+ID0gY29tcG9uZW50RmFjdG9yeVJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KENteERpYWxvZ0NvbmZpcm1hdGlvbkNvbXBvbmVudCk7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPENteERpYWxvZ0NvbmZpcm1hdGlvbkNvbXBvbmVudD4gPSB2aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUNvbXBvbmVudChjb21wb25lbnRGYWN0b3J5KTtcblxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dHlwZWRlZlxuICAgICAgICBjb25zdCBjb21wb25lbnQgPSAoY29tcG9uZW50UmVmLmluc3RhbmNlIGFzIENteERpYWxvZ0NvbmZpcm1hdGlvbkNvbXBvbmVudCk7XG4gICAgICAgIHRoaXMuc2V0RGlhbG9nU3Vic2NyaXB0aW9ucyhvcHRpb25zLCBjb21wb25lbnQuZGlhbG9nKTtcbiAgICAgICAgdGhpcy5vcGVuQ29uZmlybWF0aW9uRGlhbG9nKG9wdGlvbnMsIGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybiBjb21wb25lbnQ7XG4gICAgfVxuXG4gICAgLyogZXhwZXJpbWVudGFsICovXG4gICAgcHVibGljIGNyZWF0ZUN1c3RvbURpYWxvZyhcbiAgICAgICAgdmlld0NvbnRhaW5lclJlZjogVmlld0NvbnRhaW5lclJlZixcbiAgICAgICAgY29tcG9uZW50RmFjdG9yeVJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gICAgICAgIGNvbXBvbmVudFRlbXBsYXRlOiBDbXhEaWFsb2dDb21wb25lbnQsXG4gICAgICAgIG9wdGlvbnM6IElEaWFsb2dPcHRpb25zKTogQ214RGlhbG9nQ29tcG9uZW50IHtcblxuICAgICAgICBjb25zdCBjb21wb25lbnRGYWN0b3J5OiBDb21wb25lbnRGYWN0b3J5PENteERpYWxvZ0NvbXBvbmVudD4gPVxuICAgICAgICAgICAgY29tcG9uZW50RmFjdG9yeVJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KENteERpYWxvZ0NvbXBvbmVudCk7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPENteERpYWxvZ0NvbXBvbmVudD4gPSB2aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUNvbXBvbmVudChjb21wb25lbnRGYWN0b3J5KTtcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnR5cGVkZWZcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gKGNvbXBvbmVudFJlZi5pbnN0YW5jZSBhcyBDbXhEaWFsb2dDb21wb25lbnQpO1xuXG4gICAgICAgIGlmICghKGNvbXBvbmVudFRlbXBsYXRlIGluc3RhbmNlb2YgQ214RGlhbG9nQ29tcG9uZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldERpYWxvZ0NvbXBvbmVudChjb21wb25lbnQsIGNvbXBvbmVudFRlbXBsYXRlKTtcbiAgICAgICAgdGhpcy5zZXREaWFsb2dDb21wb25lbnRUaW1lcihvcHRpb25zLCBjb21wb25lbnQpO1xuICAgICAgICByZXR1cm4gY29tcG9uZW50O1xuICAgIH1cblxuICAgIHByaXZhdGUgc2V0RGlhbG9nU3Vic2NyaXB0aW9ucyhvcHRpb25zOiBhbnksIGNvbXBvbmVudDogYW55KTogdm9pZCB7XG4gICAgICAgIGlmIChvcHRpb25zLmFmdGVyQ2xvc2VkKSB7XG4gICAgICAgICAgICBjb21wb25lbnQuYWZ0ZXJDbG9zZWQoKS5zdWJzY3JpYmUob3B0aW9ucy5hZnRlckNsb3NlZCgpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy5hZnRlck9wZW5lZCkge1xuICAgICAgICAgICAgY29tcG9uZW50LmFmdGVyT3BlbmVkKCkuc3Vic2NyaWJlKG9wdGlvbnMuYWZ0ZXJPcGVuZWQoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIG9wZW5Db25maXJtYXRpb25EaWFsb2cob3B0aW9uczogYW55LCBjb21wb25lbnQ6IGFueSk6IHZvaWQge1xuICAgICAgICBpZiAob3B0aW9ucy50eXBlID09PSBDb25maXJtYXRpb25UeXBlLlN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5vcGVuQXNTdWNjZXNzKG9wdGlvbnMubWVzc2FnZSA/IG9wdGlvbnMubWVzc2FnZSA6IHRoaXMuZGVmYXVsdFN1Y2Nlc3NNZXNzYWdlKTtcbiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLnR5cGUgPT09IENvbmZpcm1hdGlvblR5cGUuV2FybmluZykge1xuICAgICAgICAgICAgY29tcG9uZW50Lm9wZW5Bc1dhcm5pbmcob3B0aW9ucy5tZXNzYWdlID8gb3B0aW9ucy5tZXNzYWdlIDogdGhpcy5kZWZhdWx0V2FybmluZ01lc3NhZ2UpO1xuICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMudHlwZSA9PT0gQ29uZmlybWF0aW9uVHlwZS5FcnJvcikge1xuICAgICAgICAgICAgY29tcG9uZW50Lm9wZW5Bc0Vycm9yKG9wdGlvbnMubWVzc2FnZSA/IG9wdGlvbnMubWVzc2FnZSA6IHRoaXMuZGVmYXVsdEVycm9yTWVzc2FnZSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLm1lc3NhZ2VEZXRhaWwgPyBvcHRpb25zLm1lc3NhZ2VEZXRhaWwgOiB0aGlzLmRlZmF1bHRFcnJvck1lc3NhZ2VEZXRhaWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXREaWFsb2dDb21wb25lbnQoY29tcG9uZW50OiBhbnksIGNvbXBvbmVudFRlbXBsYXRlOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgY29tcG9uZW50LmVuYWJsZUhlYWRlciA9IGNvbXBvbmVudFRlbXBsYXRlLmVuYWJsZUhlYWRlcjtcbiAgICAgICAgY29tcG9uZW50LmVuYWJsZUZvb3RlciA9IGNvbXBvbmVudFRlbXBsYXRlLmVuYWJsZUZvb3RlcjtcbiAgICAgICAgY29tcG9uZW50LmVuYWJsZUNsb3NlID0gY29tcG9uZW50VGVtcGxhdGUuZW5hYmxlQ2xvc2U7XG4gICAgICAgIGNvbXBvbmVudC5iYWNrZ3JvdW5kQ29sb3IgPSBjb21wb25lbnRUZW1wbGF0ZS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgIGNvbXBvbmVudC5ydGwgPSBjb21wb25lbnRUZW1wbGF0ZS5ydGw7XG4gICAgICAgIGNvbXBvbmVudC5kaXJBdHRyID0gY29tcG9uZW50VGVtcGxhdGUuZGlyQXR0cjtcblxuICAgICAgICBjb25zb2xlLmxvZyhjb21wb25lbnQpO1xuXG4gICAgICAgIGlmIChjb21wb25lbnQuZW5hYmxlSGVhZGVyKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuZGlhbG9nSGVhZGVyLm5hdGl2ZUVsZW1lbnQuaW5uZXJIVE1MID0gY29tcG9uZW50VGVtcGxhdGUuZGlhbG9nSGVhZGVyLm5hdGl2ZUVsZW1lbnQuaW5uZXJIVE1MO1xuICAgICAgICAgICAgfSwgdGhpcy5kaWFsb2dEZWxheSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbXBvbmVudC5lbmFibGVGb290ZXIpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5kaWFsb2dGb290ZXIubmF0aXZlRWxlbWVudC5pbm5lckhUTUwgPSBjb21wb25lbnRUZW1wbGF0ZS5kaWFsb2dGb290ZXIubmF0aXZlRWxlbWVudC5pbm5lckhUTUw7XG4gICAgICAgICAgICB9LCB0aGlzLmRpYWxvZ0RlbGF5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgY29tcG9uZW50LmRpYWxvZ0JvZHkubmF0aXZlRWxlbWVudC5pbm5lckhUTUwgPSBjb21wb25lbnRUZW1wbGF0ZS5kaWFsb2dCb2R5Lm5hdGl2ZUVsZW1lbnQuaW5uZXJIVE1MO1xuICAgICAgICB9LCB0aGlzLmRpYWxvZ0RlbGF5KTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgc2V0RGlhbG9nQ29tcG9uZW50VGltZXIob3B0aW9uczogYW55LCBjb21wb25lbnQ6IGFueSk6IHZvaWQge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0RGlhbG9nU3Vic2NyaXB0aW9ucyhvcHRpb25zLCBjb21wb25lbnQpO1xuICAgICAgICAgICAgY29tcG9uZW50Lm9wZW4oKTtcbiAgICAgICAgfSwgdGhpcy5kaWFsb2dEZWxheSk7XG4gICAgfVxufVxuIl19